<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbookxi.rng" type="xml"?>
<chapter version="5.0" xmlns="http://docbook.org/ns/docbook"
    xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude"
    xml:id="chap.pdf417">
    <title>PDF417 (2D-Barcode)</title>
    <sect1>
        <title>Principle of PDF417 Barcodes</title>
        <note>
            <para>This module is only available in the pro-version of the library.</para>
        </note>
        <para>
            <caution>
                <para>In order to use the PDF417 barcode module it is necessary for the PHP
                    installation to support the function <command>bcmod()</command>. This is enabled
                    when compiling PHP by making sure that the option <code>--enable-bcmath</code>
                    is given when configuring  PHP at compile time.</para>
            </caution>
        </para>
        <para>This first section gives a very brief explanation of the general structure of PDF417
            barcodes and some capacity figures. </para>
        <para>PDF417 was one of the first publicly available high density (capable of storing up to
            2710 data characters) two dimensional barcodes. It was originally published by Symbol
            Technologies, Inc. but has since become an ISO standard. PDF417 belongs to the early two
            dimensional barcodes which internally consists of a number of linear barcodes stacked on
            top of each other. This is in contrast to the more modern two dimensional barcodes like
                <emphasis role="italic">Datamatrix</emphasis> and <emphasis role="italic">QR
                code</emphasis> which are truly two dimensional in that they have moved away from
            the row thinking in the internal construction of the barcode.</para>
        <para>PDDF417 barcodes are extensively used for example within aviation, automobile industry
            and health care. </para>
        <para>Strictly speaking it is not necessary to know this level of detail to use the PDF417
            barcode module but we would recommend to read through this at least once since some
            parameters (like number of columns - explained below - that are used adjustable)</para>
        <para>PDF417 is an acronym for <emphasis role="italic"><emphasis role="bold"
                >P</emphasis>ortable <emphasis role="bold">D</emphasis>ata <emphasis role="bold"
                    >F</emphasis>ormat 4 of 17</emphasis> where 4 of 17 describes the structure of
            how a single data character is encoded (4 bars and 4 spaces in a 17 module wide
            structure).</para>
        <sect2>
            <title>PDF417 standard</title>
            <para>The PDF417 is high capacity two dimensional barcode and is fully described in the
                official standard ISO/IEC 15438:2001 available for purchase from <uri
                    xlink:href="http://www.iso.ch/iso/en/CombinedQueryResult.CombinedQueryResult?queryString=pdf417"
                    >ISO Standard Organization</uri>. </para>
        </sect2>
        <sect2>
            <title>Data capacity</title>
            <para>PDF417 is a row based 2 dimensional barcode that consists of a maximum of 90 rows
                and 30 columns. The maximum number of data is dependent on </para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>The compaction mode used</para>
                    </listitem>
                    <listitem>
                        <para>The number of columns (and rows)</para>
                    </listitem>
                    <listitem>
                        <para>The error correction level</para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>The maximum data size is dependent on both the compaction mode as well as the
                input data. The figures listed below will give some idea on the capacity</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>2710 digits in numeric compaction mode</para>
                    </listitem>
                    <listitem>
                        <para>1850 characters in text compaction mode</para>
                    </listitem>
                    <listitem>
                        <para>1108 bytes in byte compaction mode</para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>One barcode can hold up to a maximum of 929 codewords (data count + data + error
                correction)</para>
        </sect2>
        <sect2>
            <title>Structure of PDF417 barcodes</title>
            <para>A high level overview of the structure of a PDF417 barcode is shown in <xref
                    xlink:href="#fig.pdf417-structure-overview"/> . A PDF417 barcode can be thought
                of as a number of linear barcode stapled on top of each other. Each row in the
                barcode is constructed in a similar way.</para>
            <para>Each data word (symbol character) consists of 4 bars and four spaces in a 17
                module structure, hence the name PDF417. A more detailed explanation of a real
                PDF417 barcode is shown in <xref xlink:href="#fig.pdf417-structure-details"/></para>
            <para>There are three distinct areas in a barcode:</para>
            <para>
                <orderedlist>
                    <listitem>
                        <para><emphasis role="bold">Start and stop pattern (light red background
                                color)</emphasis>. Used to help the scanner find the start and
                            beginning of the barcode. These patterns are static and are the same for
                            all barcodes.</para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">Left and right row indicators</emphasis>. Used
                            to help the scanner orient itself in the barcode. These patterns are
                            dependent on the actual data in the barcode to achieve maximum
                            contrast.</para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">Data and data count</emphasis>. This is unique
                            for each barcode and represents the encoded data. PDF417 specifies
                            several ways to encode the characters in the input data to achieve
                            maximum compression level based on the knowledge (and restriction) on
                            the input alphabet. For example, if the data is known to be only numeric
                            the encodation can take advantage of this and make the compaction schema
                            more efficient than if also alphabetical letters have to be encoded. </para>
                        <para>The way the data is encoded is user specifiable. By default the
                            library analyses the input data and determines an optimal mix of
                            encoding suitable for this particular data.</para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">Error correction codewords</emphasis>. Each
                            PDf417 have a user selectable error correction level. Since the barcode
                            have a specified size this means that the more error correction words
                            that are used the less data can fit. The error correction words are
                            added to the end of the payload data, each barcode has a minimum of 2
                            error detection codewords. Up to 510 additional error correction
                            codewords can be added for maximum data correction.</para>
                    </listitem>
                </orderedlist>
            </para>
            <para>
                <figure xml:id="fig.pdf417-structure-overview">
                    <title>PDF417 Structure - Overview</title>
                    <mediaobject>
                        <imageobject><imagedata scale="75"
                                fileref="images/pdf417-structure-overview-smaller.png"
                            /></imageobject>
                    </mediaobject>
                </figure>
            </para>
            <para>In <xref xlink:href="#fig.pdf417-structure-details"/> the distinct data column
                (which on each row holds one data word) are indicated at the bottom
                (w1,w2,w3,w4,w5). This particular barcode have 8 rows and 5 columns which means that
                the total number of data words + error correction words encoded are 8x5 = 40.</para>
            <para>
                <figure xml:id="fig.pdf417-structure-details">
                    <title>PDF417 Structure - Details of a real barcode</title>
                    <mediaobject>
                        <imageobject><imagedata fileref="images/pdf417-structure-details.png"
                                scale="60"/></imageobject>
                    </mediaobject>
                </figure>
            </para>
            <para>The data to be converted into a barcode has to go through a number of steps which
                are handled by the library:</para>
            <para>
                <orderedlist>
                    <listitem>
                        <para>The first step is a high level compression schema known as compaction.
                            This schema translates the input string into a number of codewords. Each
                            codeword has a numeric value between 0 and 928. To achieve the highest
                            possible compaction and flexibility the PDF417 standard defined three
                            different compaction schema:</para>
                        <para>
                            <itemizedlist>
                                <listitem>
                                    <para>numeric (encodes only digits 0-9, ASCII 30-39). This
                                        schema can compact up to 2.9 digits per codeword (and has
                                        the highest density)</para>
                                </listitem>
                                <listitem>
                                    <para>byte (encodes ASCII 0-255). This schema can only compact
                                        up to 1.2 bytes per codeword (and has the lowest
                                        density)</para>
                                </listitem>
                                <listitem>
                                    <para>text (which encodes ASCII 32-126). This schema can compact
                                        up to 1.8 characters per codeword.</para>
                                </listitem>
                            </itemizedlist>
                        </para>
                    </listitem>
                    <listitem>
                        <para>The second step is the transformation of codeword into (4,17) symbols.
                            The exact symbol used is dependent on which row the codeword to be
                            encoded is on. Three different sets of codewords, known as clusters, are
                            used. This ensures that two adjacent rows uses different clusters. This
                            allows the barcode to be scanned without using specific divider
                            symbols.</para>
                    </listitem>
                    <listitem>
                        <para>In the third step the error codewords specified are calculated and
                            added to the end of the payload data. The error correction uses
                            polynomial Reed-Solomon error correcting coding (same schema as used on
                            CD:s) to achieve a good balance between error correcting efficiency and
                            computational effort and space requirements. </para>
                    </listitem>
                    <listitem>
                        <para>Finally these codeword are positioned sequentially in each row
                            starting at the top left corner down to the bottom right in between the
                            left and right row indicators, and the start and stop patterns.</para>
                    </listitem>
                </orderedlist>
            </para>
            <para>By necessity this s a fairly shallow description where we have omitted many
                technical details in the encodation process. We therefore refer to the official
                standard which gives much more technical details on the encodation process. </para>
        </sect2>
    </sect1>
    <sect1>
        <title>Creating barcodes</title>
        <sect2>
            <title>Introduction</title>
            <para>The library allows the creation of PDF417 barcodes as either images (in either PNG
                or JPEG format) or as a Postscript files. In addition the barcode extension provides
                extensive data verification which makes it impossible to create an invalid
                barcode</para>
            <sect3>
                <title>Verification</title>
                <para>The JpGraph PDF417 barcode module have been extensively verified using an
                    ARGOX 8213 2D CCD handhold scanner. </para>
            </sect3>
            <sect3>
                <title>Features</title>
                <para>This is a summary of the features available in the JpGraph PDF417 barcode
                    extension. </para>
                <para>
                    <itemizedlist>
                        <listitem>
                            <para>Supports both standard and truncated PDF 417 codes</para>
                        </listitem>
                        <listitem>
                            <para>Output format </para>
                            <para>
                                <orderedlist>
                                    <listitem>
                                        <para>Image format, (any of the formats supported by the
                                            library)</para>
                                    </listitem>
                                    <listitem>
                                        <para>Postscript</para>
                                    </listitem>
                                    <listitem>
                                        <para>Encapsulated postscript</para>
                                    </listitem>
                                </orderedlist>
                            </para>
                        </listitem>
                        <listitem>
                            <para>Supports both auto and user selectable number of columns and
                                rows</para>
                        </listitem>
                        <listitem>
                            <para>Supports all 8 possible error correction levels</para>
                        </listitem>
                        <listitem>
                            <para>Supports all defined compaction schemes, Alpha, Numeric and Byte.
                                In addition the library has an optimization algorithm that will
                                determine the best possible encoding given a specific input
                                data.</para>
                        </listitem>
                        <listitem>
                            <para>User specified module height</para>
                        </listitem>
                        <listitem>
                            <para>User specified module width factor</para>
                        </listitem>
                        <listitem>
                            <para>User specified overall image scaling of resulting barcode</para>
                        </listitem>
                        <listitem>
                            <para>Horizontal or vertical barcode layout</para>
                        </listitem>
                        <listitem>
                            <para>Optional human readable text at the bottom of the barcodes with
                                selectable font and size</para>
                        </listitem>
                        <listitem>
                            <para>Foreground and background color specification</para>
                        </listitem>
                    </itemizedlist>
                </para>
            </sect3>
            <sect3>
                <title>Sample application</title>
                <para>Even though the library module is meant, and designed, to be used as a library
                    within a larger system there is a small demo barcode creation application
                    included in the distribution. This application can be used to easily create
                    barcode through it's WEB interface as can be seen in <xref
                        xlink:href="#fig.pdf417-demoapp"/></para>
                <para>This application is primarily included as a demo on the features available in
                    the library and not as a finalized product.</para>
                <para>The application is available at
                        "<filename>pdf417/demoapp/index.html</filename>" in the distribution. </para>
                <para>
                    <figure xml:id="fig.pdf417-demoapp">
                        <title>PDF417 WEB-based demo application</title>
                        <mediaobject>
                            <imageobject><imagedata fileref="images/pdf417-demoapp.png" scale="60"
                                /></imageobject>
                        </mediaobject>
                    </figure>
                </para>
                <para>The fields in the demo application has the following meaning</para>
                <para>
                    <itemizedlist>
                        <listitem>
                            <para><emphasis role="bold">Data:</emphasis> Data to be encoded. This
                                should be entered as a standard string.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">Encoding:</emphasis> Determine the
                                compaction schema to be used</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">Columns:</emphasis> Number of data columns
                                to be used</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">Error level:</emphasis> What error level to
                                be used</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">Module width:</emphasis> Module width</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">Height factor:</emphasis> Specify the height
                                of the individual rows in the barcode as a multiplier of the
                                width.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">Scale:</emphasis> Scale factor.</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">Text:</emphasis> Should the human readable
                                text be shown?</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">Vertical:</emphasis> Should the barcode use
                                vertical layout?</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">Frame:</emphasis> Should a frame be added to
                                the barcode?</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">Truncated:</emphasis> Should the barcode be
                                truncated?</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">File:</emphasis> If specified the output
                                will be written to this file</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">PS Module:</emphasis> If specified will be
                                used as the module width for PS</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">Format:</emphasis> If specified will set
                                what image encoding will be used output</para>
                        </listitem>
                        <listitem>
                            <para><emphasis role="bold">Debug info:</emphasis> Will open a new frame
                                and display some internal debugging information from the
                                library.</para>
                        </listitem>
                    </itemizedlist>
                </para>
            </sect3>
        </sect2>
    </sect1>
    <sect1>
        <title>Creating barcodes</title>
        <para>In order to access the PDF417 functionality the module
                "<filename>pdf417/jpgraph_pdf417.php</filename>" must first be included.</para>
        <para>Usage of PDF417 barcodes follows a similar schema as for the linear barcodes with the
            concepts of an encoder and backend. The principle of the overall encodation process is
            shown in <xref xlink:href="#fig.pdf417-encodation-overview"/></para>
        <para>
            <figure xml:id="fig.pdf417-encodation-overview">
                <title>Overview of the interaction between encoder and backends</title>
                <mediaobject>
                    <imageobject><imagedata fileref="images/pdf417-encodation-principle.png"
                            scale="60"/></imageobject>
                </mediaobject>
            </figure>
        </para>
        <para>In order to create a PDf417 barcode the following principle steps are needed</para>
        <para>
            <orderedlist>
                <listitem>
                    <para>Create an instance of the PDF417 encoder (as an instance of <code>class
                            PDF417Barcode</code> )</para>
                </listitem>
                <listitem>
                    <para>Create an instance of a backend to produce the wanted output (image,
                        postscript or encapsulated postscript) by using the static factory method
                            <code>PDF417BackendFactory::Create()</code></para>
                </listitem>
                <listitem>
                    <para>Encode data and send it back to the browser or a file with a call to the
                        backend <code>Stroke()</code> method.</para>
                </listitem>
            </orderedlist>
        </para>
        <para>The following script shows how to create the simplest possible barcode (in PNG format)
            representing the data string "PDF-417" encoded using default number of columns and the
            default error correction level </para>
        <para>
            <programlisting>#pdf417_ex0|The most basic PDF417 script#</programlisting>
        </para>
        <para>As can bee seen from the code above the basic interface to the library makes use of
            one abstract factory to create the appropriate output backend. This design makes the
            addition of new output formats transparent for the end user of the library.</para>
        <para>The example above does not have any error handling. If there is some error in the
            process an exception will be thrown in the same way as in other places in the library.
            The default exception will display the standard library image error box. If we instead
            always wanted to do some additional processing and perhaps just display a text based
            re-formatted error message we could change the above code to catch this exception as the
            following example shows</para>
        <para>
            <programlisting>#pdf417_ex1|Adding error handling#</programlisting>
        </para>
        <para>when an exception is thrown it will be caught and the error string echoed. If instead
            we wanted to specifically encode the data using 8-columns and using error detection
            level 5 the code would have to be modified to </para>
        <para>
            <programlisting>#pdf417_ex1b|Adjusting the number of columns and error correction level#</programlisting>
        </para>
        <para>Later on we will go through all the different options available both on the encoder
            and on the backends. But for now let's just show how easy it is to change the size of
            the barcode and add a human readable text at the bottom of the bar from the example
            above.</para>
        <para>In the same way as for linear barcode the concept of "module width" is used. This is
            basically the width of a unit bar in the barcode. Remember that each codeword is made up
            of 17 modules where there are 4 black and 4 white areas of various width. The width of
            the module is specified with the backend method</para>
        <para>
            <itemizedlist>
                <listitem>
                    <para><code>Backend::SetModuleWidth($aWidth)</code></para>
                </listitem>
            </itemizedlist>
        </para>
        <para>For images this is specified in pixels and for a postscript backend this is
            interpretated as specifying the number of points (1 pt = 1/72 inch).</para>
        <para>To add a human readable version of the data at the bottom of the barcode we use the
            method</para>
        <para>
            <itemizedlist>
                <listitem>
                    <para><code>Backend::ShowText($aShow=true)</code></para>
                </listitem>
            </itemizedlist>
        </para>
        <para>Adding these tow method calls to our previous example will give us the following code
            and resulting barcode.</para>
        <para>
            <programlisting>#pdf417_ex2|Adjusting the module width and showing human readable text#</programlisting>
        </para>
        <para>In the remainder of this chapter we will explain in more detail what other formatting
            options are available.</para>
    </sect1>
    <sect1>
        <title>Specifying the PDF417 parameters</title>
        <para>
            <note>
                <para>The following section is not meant as a general introduction to the way PDF417
                    barcode is specified. It assumes that the reader has a basic understanding of
                    the nature of PDF417 encoding. This section will focus on how to make use of the
                    methods in the library to specify the various settings for the PDF417 barcodes.
                </para>
            </note>
        </para>
        <sect2>
            <title>Specifying encoding and input data</title>
            <para>The absolute simplest way of encoding data is simply to create a simple string
                representing the data to be encoded and then pass that string as the first argument
                to the <code>Stroke()</code> method in the backend. The encoder will then analyze
                the input data and choose the most efficient space saving encoding schema for this
                data. </para>
            <para>The PDF417 standard allows 3 different compaction schema that can be used to
                minimize the number of codewords used for a particular data string. This also means
                that a particular data string may have several different valid barcodes that
                visually looks different. </para>
            <para>The available compaction modes are:</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para><emphasis role="bold">Alpha compaction mode</emphasis> (also known as
                            Text compaction mode). Efficient encoding of ASCII 32-126, (inclusively)
                            i.e. the normal alphabet including numbers. Encodes 1.8 characters per
                            codeword.</para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">Numeric compaction mode.</emphasis> Efficient
                            encoding of numeric data. For long consecutive strings of digits this
                            gives a better compaction than the alpha mode. Numeric compaction
                            encodes about 2.9 digits per codeword.</para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">Byte compaction mode.</emphasis> The least
                            efficient encoding. Used only when there is a need to encode byte values
                            as is, i.e. values in the range 0-255. Please note that many barcode
                            readers, especially those with a keyboard wedge, don't send back the
                            proper encoding for ASCII values lower than 32 or higher than 126. Byte
                            compaction mode encodes roughly 1.2 byte per codeword.</para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>When the automatic encoding is chosen this will create an optimum encoding (from a
                size perspective) of the supplied data. This includes shifting encoding method in
                the middle of the data one or several time depending on the structure of the data. </para>
            <para>It is also possible to manually control the exact encodation of the input data.
                This is done by supplying one or more data tuples where the first entry in the tuple
                is the compaction schema and the second the data. To encode the data manually the
                following structure must then be followed:</para>
            <para>
                <figure>
                    <title>Structure for manually specified encodation schema</title>
                    <screen>$data = array( array( &lt;encoding_mode1> , &lt;data1> ),
               array( &lt;encoding_mode2> , &lt;data2> ),
                         ...
               array( &lt;encoding_modeN> , &lt;dataN> ));</screen>
                </figure>
            </para>
            <para>The encoding mode is specified as one of three symbolic constants</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para><code>USE_TC</code>, (short for <emphasis role="bold"
                                >USE</emphasis>-<emphasis role="bold">T</emphasis>ext<emphasis
                                role="bold">C</emphasis>ompaction) Use Text compaction schema</para>
                    </listitem>
                    <listitem>
                        <para><code>USE_NC</code>, (short for <emphasis role="bold"
                                >USE</emphasis>-<emphasis role="bold">N</emphasis>umerical-<emphasis
                                role="bold">C</emphasis>ompaction) Use Numeric compaction
                            schema</para>
                    </listitem>
                    <listitem>
                        <para><code>USE_BC</code>, (short for <emphasis role="bold"
                                >USE</emphasis>-<emphasis role="bold">B</emphasis>yte<emphasis
                                role="bold">C</emphasis>ompaction) Use Byte compaction schema</para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>and the data is specified as a regular text string. Each section of data must
                therefore have the compaction mode specified. </para>
            <para><emphasis role="bold">Example 1:</emphasis></para>
            <para>In the following example we will assume that we want to encode the data string </para>
            <para>
                <programlisting>$data="1234567890" </programlisting>
            </para>
            <para>To use automatic encoding then there is nothing more than specifying this data to
                the <code>Backend::Stroke()</code> method as</para>
            <para>
                <programlisting>$backend->Stroke($data);</programlisting>
            </para>
            <para>If instead we wanted to make sure that only alpha mode (text) compaction schema is
                used the input data would have to be changed to </para>
            <para>
                <programlisting>&lt;?php
$data="1234567890" 
$newdata = array(array( USE_TC, $data ));
...
$backend->Stroke($newdata);
?></programlisting>
            </para>
            <para>this will then force the input string to be encoded using only the text compaction
                schema.</para>
            <para>If instead we wanted to enforce only numeric compaction the code would have to be
                changed to</para>
            <para>
                <programlisting>&lt;?php
$data="1234567890" 
$newdata = array(array( USE_NC, $data ));
...
$backend->Stroke($newdata);
?></programlisting>
            </para>
            <para>this will then force the input data string to be encoded using numeric compaction
                schema. &#8718;</para>
            <para>In the above example we just used a single compaction schema to use multiple
                encodation schema we just need to split our data for each of the compaction mode we
                want to use and create an input array. An example will make this clear.</para>
            <para><emphasis role="bold">Example 2:</emphasis></para>
            <para>We will assume that we want to encode the string <code>"1234abc567"</code> by
                using numeric compaction for the first 4 digits, then use text compaction for the
                three letters and finally go back to numeric compaction schema for the last three
                digits. For this to work we would have to create an input array as shown below. </para>
            <para>
                <programlisting>&lt;?php
$newdata = array(array( USE_NC, '1234'), 
                 array( USE_TC, 'abc'), 
                 array( USE_NC, '567'));
...
$backend->Stroke($newdata);
?></programlisting>
            </para>
            <para>&#8718;</para>
            <para>
                <note>
                    <para>Normally there are very few reasons to specify the encodation schema
                        manually and it is therefore better to let the library determine the optimum
                        encoding by itself.</para>
                </note>
            </para>
            <sect3>
                <title>Using byte compaction mode</title>
                <para>Using byte compaction mode is however slightly more complex. The reason is
                    that we need, for technical reasons, specify if the size (length) of the data to
                    be encoded is an even multiple of 6 or not. </para>
                <para>Hence, there are actually two Byte code compaction schema </para>
                <para>
                    <orderedlist>
                        <listitem>
                            <para><code>USE_BC_E6</code> (for even multiples of 6) </para>
                        </listitem>
                        <listitem>
                            <para><code>USE_BC_O6</code> (for odd data).</para>
                        </listitem>
                    </orderedlist>
                </para>
                <para>So to encode data using byte compaction mode the following template should be
                    used to determine the proper byte compaction variant.</para>
                <para>
                    <programlisting>&lt;?php
$even6 = ( strlen($data) % 6 === 0 );
$newdata = array(array( $even6 ? USE_BC_E6 : USE_BC_O6, $data));
...
$backend->Stroke($newdata);
?></programlisting>
                </para>
                <para>
                    <caution>
                        <para>Remember that <code>strlen()</code> is not multi byte character
                            encodation safe. If multi-byte characters should be encoded then the
                                <code>mb_strlen()</code> should be used.</para>
                    </caution>
                </para>
                <para>
                    <caution>
                        <para>Note that several keyboard wedge barcode scanners do not handle byte
                            values &lt; 32 or > 127 properly.</para>
                    </caution>
                </para>
            </sect3>
        </sect2>
        <sect2>
            <title>Encoder option: Adjusting the number of data columns</title>
            <para>PDF417 barcode is made up of a number of rows and columns. The library allows the
                specification of the number of columns and it will then determine the necessary
                number of rows to hold all the given data + the error correction information. </para>
            <para>Since each row has some overhead (start/stop and sync codewords) the overall area
                taken by the barcode will be minimized by trying to use as many columns as possible.
                The standards allow for up to 30 columns (and 90 rows). The most practical limit is
                how wide data the scanner is able to handle. Most hand hold scanner will usually not
                work very reliable with barcodes which are more than ~10cm wide.</para>
        </sect2>
        <sect2>
            <title>Encoder option: Adjusting the error level</title>
            <para>All PDF417 barcodes have a minimum of two error detection codewords. Above that
                the user is free to specify a higher level which will allow not only error detection
                but also (some) error correction.</para>
            <para>The error level determines how much redundancy is added in the barcode label. A
                high level of redundancy ensures that a partially damaged barcode can still be
                correctly read by the barcode scanner. The downside is that the higher the error
                level the larger the barcode gets and since the total number of codewords in a
                PDF417 barcode has a maximum limit of 928 also less real data. <xref
                    xlink:href="#table.pdf417-error-levels"/> shows the available error levels and
                how that will impact the maximum data payload. <xref
                    xlink:href="#table.pdf417-error-levels"/> also shows the error correcting
                capacity. For example using error level 4 means that 15 of the codewords can have
                errors and still be corrected.</para>
            <para>
                <table frame="all" xml:id="table.pdf417-error-levels">
                    <title>Available error levels</title>
                    <tgroup cols="4">
                        <colspec colname="c1" colnum="1"/>
                        <colspec colname="c2" colnum="2"/>
                        <colspec colname="newCol3" colnum="3"/>
                        <colspec colname="c3" colnum="4"/>
                        <thead>
                            <row>
                                <entry>Error level </entry>
                                <entry>
                                    <para>Error correction </para>
                                    <para>codewords</para>
                                </entry>
                                <entry>
                                    <para>Error correction </para>
                                    <para>capacity</para>
                                </entry>
                                <entry>
                                    <para>Maximum </para>
                                    <para>payload</para>
                                </entry>
                            </row>
                        </thead>
                        <tbody>
                            <row>
                                <entry align="center">
                                    <para>0</para>
                                </entry>
                                <entry align="center">
                                    <para>2</para>
                                </entry>
                                <entry align="center">0</entry>
                                <entry align="center">
                                    <para>923</para>
                                </entry>
                            </row>
                            <row>
                                <entry align="center">
                                    <para>1</para>
                                </entry>
                                <entry align="center">
                                    <para>4</para>
                                </entry>
                                <entry align="center">1</entry>
                                <entry align="center">
                                    <para>921</para>
                                </entry>
                            </row>
                            <row>
                                <entry align="center">
                                    <para>2</para>
                                </entry>
                                <entry align="center">
                                    <para>8</para>
                                </entry>
                                <entry align="center">3</entry>
                                <entry align="center">
                                    <para>917</para>
                                </entry>
                            </row>
                            <row>
                                <entry align="center">
                                    <para>3</para>
                                </entry>
                                <entry align="center">
                                    <para>16</para>
                                </entry>
                                <entry align="center">7</entry>
                                <entry align="center">
                                    <para>909</para>
                                </entry>
                            </row>
                            <row>
                                <entry align="center">
                                    <para>4</para>
                                </entry>
                                <entry align="center">
                                    <para>32</para>
                                </entry>
                                <entry align="center">15</entry>
                                <entry align="center">
                                    <para>893</para>
                                </entry>
                            </row>
                            <row>
                                <entry align="center">
                                    <para>5</para>
                                </entry>
                                <entry align="center">
                                    <para>64</para>
                                </entry>
                                <entry align="center">31</entry>
                                <entry align="center">
                                    <para>861</para>
                                </entry>
                            </row>
                            <row>
                                <entry align="center">
                                    <para>6</para>
                                </entry>
                                <entry align="center">
                                    <para>128</para>
                                </entry>
                                <entry align="center">63</entry>
                                <entry align="center">
                                    <para>797</para>
                                </entry>
                            </row>
                            <row>
                                <entry align="center">
                                    <para>7</para>
                                </entry>
                                <entry align="center">
                                    <para>256</para>
                                </entry>
                                <entry align="center">127</entry>
                                <entry align="center">
                                    <para>669</para>
                                </entry>
                            </row>
                            <row>
                                <entry align="center">
                                    <para>8</para>
                                </entry>
                                <entry align="center">
                                    <para>512</para>
                                </entry>
                                <entry align="center">255</entry>
                                <entry align="center">
                                    <para>413</para>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
            </para>
            <para>The recommended minimum error level is a dependent on the payload size and is
                given below.</para>
            <para>
                <table frame="all">
                    <title>Recommended error levels</title>
                    <tgroup cols="2">
                        <colspec colname="c1" colnum="1"/>
                        <colspec colname="c2" colnum="2"/>
                        <thead>
                            <row>
                                <entry>
                                    <para>Data codewords</para>
                                </entry>
                                <entry>
                                    <para>Recommended </para>
                                    <para>error level</para>
                                </entry>
                            </row>
                        </thead>
                        <tbody>
                            <row>
                                <entry>
                                    <para>1 to 40</para>
                                </entry>
                                <entry align="center">
                                    <para>2</para>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <para>41 to 160</para>
                                </entry>
                                <entry align="center">
                                    <para>3</para>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <para>161 to 320</para>
                                </entry>
                                <entry align="center">
                                    <para>4</para>
                                </entry>
                            </row>
                            <row>
                                <entry>
                                    <para>321 to 863</para>
                                </entry>
                                <entry align="center">
                                    <para>5</para>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
            </para>
            <para>Note that the number of codewords is not the same thing as, for example, the
                number of digits or letters in a string to be encoded. Depending on the chosen
                encoding the number of symbols per codeword is always > 1. For example in numeric
                compaction mode (encoding) each codewords encode, on average, 2.93 digits. </para>
            <para>The error level is specified as an integer in the range [0-8] inclusively and can
                be specified when creating a particular encoder. For example the code below uses the
                default error correction (2). </para>
            <para>
                <programlisting>&lt;?php
// Use 10-columns for data
$columns =10;

// Create a new encode using the default error correction
$encoder = new PDF417Barcode ($columns);
?></programlisting>
            </para>
            <para>While the following specifies an error correction level of 6 </para>
            <para>
                <programlisting>&lt;?php
$columns = 10; // Use 10-columns for data
$errlevel = 6; // Error correction level 6

// Create a new encode using the default error correction
$encoder = new PDF417Barcode ($columns, $errlevel);
?></programlisting>
            </para>
            <para>In addition to specifying the number of data columns and error level in the
                creation of the encoder it is also possible to adjust them afterwards. </para>
            <para>For example, it might be necessary to create the encoder in the beginning of a
                script and then use the same encoder with different settings controlled by, for
                example, entries in a DB. </para>
            <para>The two encoder methods</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para><code>Encoder::SetErrLevel($aErrLevel)</code></para>
                    </listitem>
                    <listitem>
                        <para><code>Encoder::SetColumns($aColumns)</code></para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>are used for this purpose. The code snippet below does the exact same things as
                the code snippet above but using these two methods after the encoder has been
                instantiated instead.</para>
            <para>
                <programlisting>&lt;?php
$columns = 10; // Use 10-columns for data
$errlevel = 6; // Error correction level 6

// Create a new encode using the default error correction
$encoder = new PDF417Barcode();
$encoder->SetColumns($columns);
$encoder->SetErrLevel($errlevel);
?></programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Truncated PDF417</title>
            <para>
                <warning>
                    <para>Not all PDF417 barcode readers can handle truncated PDF417</para>
                </warning>
            </para>
            <para>In situations where the physical size of the label is restricted one might use the
                truncated version of the PDF417 code. </para>
            <para>This works by simply stripping of some redundant information on the right side of
                the barcode. This will also make the barcode more sensible for damage. </para>
            <para>The two images below shows a normal version together with the truncated version
                (both barcodes encode the same information). </para>
            <para>
                <informaltable frame="none">
                    <tgroup cols="2">
                        <colspec colname="c1" colnum="1"/>
                        <colspec colname="c2" colnum="2"/>
                        <tbody>
                            <row>
                                <entry>
                                    <para>
                                        <figure>
                                            <title>Normal PDF417</title>
                                            <mediaobject>
                                                <imageobject><imagedata scale="60"
                                                  fileref="images/pdf417_trunc01.png"
                                                  /></imageobject>
                                            </mediaobject>
                                        </figure>
                                    </para>
                                </entry>
                                <entry>
                                    <para>
                                        <figure>
                                            <title>Truncated PDF417</title>
                                            <mediaobject>
                                                <imageobject><imagedata scale="60"
                                                  fileref="images/pdf417_trunc02.png"
                                                  /></imageobject>
                                            </mediaobject>
                                        </figure>
                                    </para>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </informaltable>
            </para>
            <para>To use the truncated version the method the following encoder method is
                used</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para><code>Encoder::SetTruncated($aFlg=true)</code></para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>The following code snippet shows how this can be used</para>
            <para>
                <programlisting>&lt;?php
$columns = 10; // Use 10-columns for data
$errlevel = 4; // Error correction level 4
$truncated = true;

// Create a new encode using the default error correction
$encoder = new PDF417Barcode();
$encoder->SetTruncated($truncated);
$encoder->SetColumns($columns);
$encoder->SetErrLevel($errlevel);
?></programlisting>
            </para>
        </sect2>
    </sect1>
    <sect1>
        <title>Adjusting the output</title>
        <para>This section deals with the way you can adjust the visual quality and appearance of
            the output by adjusting a number of properties on the backend.</para>
        <sect2>
            <title>Output format</title>
            <para>By choosing the appropriate backend you can choose to generate the barcode label
                as either an image (in either PNG or JPEG format) or as Postscript (both standalone
                and Encapsulated postscript) . For images the PNG is strongly recommended and used
                by default. The reason is that PNG is a non-destructive format and will ensure the
                maximum quality of the barcodes while JPEG is not well suited for this type of
                applications since it is a destructive format. </para>
            <para>This choice is being made by creating the appropriate backend. The backend is
                created by calling the factory method <code>PDF417BackendFactory::Create()</code>
                specifying what type of backend and what encoder to use. The backend factory will
                then return a suitable encoder.</para>
            <para>The following code snippet shows how to create a backend that will generate an
                image.</para>
            <para>
                <programlisting>&lt;?php
// Create a new encode using the default error correction
// and columns
$encoder = new PDF417Barcode ();
$backend = PDF417BackendFactory::Create( BACKEND_IMAGE, $encoder);
?></programlisting>
            </para>
            <para>It is also possible to have one encoder and two different backends to allow the
                creation of both image and postscript output at the same time as the following
                example shows </para>
            <para>
                <programlisting>&lt;?php
$date='ABC123';
$file=' ...'; // Some filename to write the PS file to

// Create a new encode using the default error correction
// and columns
$encoder = new PDF417Barcode ();

$eImg = PDF417BackendFactory::Create( BACKEND_IMAGE, $encoder);
$eEPS = PDF417BackendFactory::Create( BACKEND_EPS, $encoder);
$eEPS->Stroke($data,$file);
$eImg->Stroke($data);
?></programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Summary of user settings for the backend</title>
            <para>In the list below is a short description of the available possibilities to change
                the output. For a more detailed explanation of the parameters for each method please
                consult the method reference at the end of this chapter</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para><emphasis role="bold">Specifying the module width.</emphasis> The
                            module width for the barcode is user selectable, For images this
                            specifies the number of pixels for the module and for Postscript output
                            this specifies the number of points (1/72 inch).</para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">Specifying the width/height factor</emphasis>
                            Specify the height of each individual row in the barcode as a multiple
                            of the width. By default the height is 3x the width.</para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">Specifying background and foreground
                                color</emphasis> The foreground color and the background color for
                            the barcodes are user selectable. The colors can be specified as any of
                            JpGraphs builtin colors.</para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">Adding human readable text</emphasis> This is an
                            extension to the PDF417 standard. This adds a plaintext string of the
                            data that has been encoded under the barcode. This is useful when
                            debugging applications to make sure that the right values have been
                            read, for example, from a DB.</para>
                    </listitem>
                    <listitem>
                        <para>Rotating 90 degrees (Vertical output) This enables the barcode to be
                            printed vertically.</para>
                    </listitem>
                    <listitem>
                        <para>Scaling the image The resulting barcode images can be scaled by an
                            arbitrary factor.</para>
                    </listitem>
                </itemizedlist>
            </para>
        </sect2>
    </sect1>
    <sect1>
        <title>A template to create barcodes</title>
        <para>In the example directory in the distribution ('<filename>pdf417/examples</filename>')
            you can find many more examples on how to create barcodes. As a good start the following
            (simple) template may be used as a base for further customizations.</para>
        <para>
            <programlisting>&lt;?php
require_once('jpgraph/pdf417/jpgraph_pdf417.php');

$data = 'PDF-417';

// Specification for barcode

$columns = 8;   // Use 8 data (payload) columns
$errlevel = 4;  // Use error level 4
$modwidth = 2;  // Setup module width (in pixels)
$height = 2;    // Height factor (=2)
$truncated = false; // Don't truncate 
$showtext = false;  // Show human readable string

// Create a new encoder and backend to generate images
try {
	$encoder = new PDF417Barcode($columns,$errlevel);
    $encoder->SetTruncated ($truncated); 
	$backend = PDF417BackendFactory::Create(BACKEND_IMAGE,$encoder);
    $backend->SetModuleWidth($modwidth);
    $backend->SetHeight($height);
    $backend->NoText(!$showtext);
    $backend->Stroke($data);
}
catch(JpGraphException $e) {
	echo 'PDF417 Error: '.$e->GetMessage();
}
?></programlisting>
        </para>
    </sect1>
    <sect1>
        <title>Method reference</title>
        <sect2>
            <title>Encoder methods</title>
            <para>All encoder methods are accessed on an instance of <code>class
                    PDF417Barcode</code>
            </para>
            <para>
                <programlisting>...
$encoder = new PDF417Barcode($columns,$errlevel);
...</programlisting>
            </para>
            <sect3>
                <title>PDF417Barcode</title>
                <para><code>PDF417Barcode($aNumCols=10, $aErrLevel=2)</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>To create a new PDF417 encoder with a chosen number of columns and error
                    level. Please note that these parameters can also be adjusted using the methods
                    described below. The method will throw exceptions if the parmeters are outside
                    there valid range.</para>
                <para><code>$aNumCols</code> , an integer in the range [2,30]</para>
                <para><code>$aErrLevel</code>, an integer in the range [0,8]</para>
                <para><emphasis role="bold">Returns:</emphasis></para>
                <para>A new encoder which is used by the backend to generate the barcode
                    label.</para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>// Create a new encoder with 20 columns
$encoder = new PDF417Barcode(20);</programlisting>
                </para>
            </sect3>
            <sect3>
                <title>SetColumns</title>
                <para><code>SetColumns($aCols)</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>Specify number of data columns. This should be a value in the range [2-30]
                    (inclusively) . Note that it is also possible to specify the number of columns
                    in the instantiation of the encoder.</para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>// Create a new encoder with 20 columns
$encoder = new PDF417Barcode();
$encoder->SetColumns(20);</programlisting>
                </para>
                <para><emphasis role="bold">Note:</emphasis></para>
                <para>The number of rows will be automatically adjusted to fit the data and the
                    error correction codewords as specified by the error level setting. The number
                    of rows is not directly user configurable.</para>
            </sect3>
            <sect3>
                <title>SetErrLevel</title>
                <para><code>SetErrLevel($aErrLevel)</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>Specify the chosen level of error correction. </para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>$encoder = new PDF417Barcode();
$encoder->SetErrLevel(5);</programlisting>
                </para>
                <para><emphasis role="bold">Note:</emphasis></para>
                <para>A high error level will limit the number of payload data since the total
                    number of data in the label is fixed.</para>
            </sect3>
            <sect3>
                <title>SetTruncated</title>
                <para><code>SetTruncated($aTrunc=true)</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>Specify that barcode should use the truncated PDF format. This will make the
                    barcode slightly narrower and might be used where the physical space is at
                    premium. </para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>$encoder = new  PDF417Barcode();
$encoder->SetTruncated ();</programlisting>
                </para>
                <para><emphasis role="bold">Note:</emphasis></para>
                <para>Not all barcode scanners can handle truncated PDF417.</para>
            </sect3>
        </sect2>
        <sect2>
            <title>Common backend methods</title>
            <para>The backend is responsible for the actual output of the barcode (see <xref
                    xlink:href="#fig.pdf417-encodation-overview"/>). </para>
            <para>It is possible to either create an image or a postscript backend. In the creation
                of the backend an instance of the encoder is given as the second argument. The
                actual output from the script (to create the barcode label) is done with a call to
                the <code>Backend::Stroke()</code> method. As usual this call should be the last
                line in the script if it is used to send the image back to the browser. </para>
            <para>The method call to Stroke() should always be guarded with a <code>try{} catch
                    {}</code> statement.</para>
            <para><emphasis role="bold">Example:</emphasis></para>
            <para>
                <programlisting>try {
    $encoder = new  PDF417Barcode( $columns, $errlevel);
    $backend = PDF417BackendFactory::Create( BACKEND_IMAGE, $encoder);

    // .. Output formatting
    $backend->Stroke();
}
catch(JpGraphException $e) {
	echo 'PDF417 Error: '.$e->GetMessage();
}</programlisting>
            </para>
            <para>In the example above we have chosen to create an image encoder (specified by
                constant <code>BACKEND_IMAGE</code>) by default the image format used will be PNG
                which is also the recommended format.</para>
            <sect3>
                <title>Stroke</title>
                <para><code>Stroke($aData, $aFile='')</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>Encode a specific data string entered as the first argument and send the
                    barcode output, depending on backend, either directly back to the browser as an
                    image or return the Postscript representation as a string. </para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>&lt;?php
// Data to be encoded
$data = ... ;

try {
    ...
    $backend->Stroke($data);
} catch( JpGraphException $e) {
    ...
}
?></programlisting>
                </para>
            </sect3>
            <sect3>
                <title>SetVertical</title>
                <para><code>SetVertical($aFlg=true)</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>Draw the barcode vertically instead of the default horizontal direction</para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>$backend->SetVertical();</programlisting>
                </para>
            </sect3>
            <sect3>
                <title>SetScale</title>
                <para><code>SetScale($aScale)</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>Will arbitrary scale the generated barcode image. Scale factor is specified as
                    a floating point number . </para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>$backend->SetScale(2.5);</programlisting>
                </para>
            </sect3>
            <sect3>
                <title>SetModuleWidth</title>
                <para><code>SetModuleWidth($aWidth)</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>Specifies the module width to be used in the barcode. The module width is
                    interpretated differently depending on whether it is applied on an image or a
                    postscript backend. The module width will determine the physical width of the
                    overall barcode. Please make sure that the printer has good enough resolution to
                    handle the chosen module width. </para>
                <para>For image backends is specifies the number of pixels to be used for the width
                    of one module in the barcode. The module can be thought of as the thinnest line
                    printed in the barcode. Each codeword is encoded 17 modules wide where there are
                    4 black and 4 white separated areas.</para>
                <para>Even though most modern inkjet printers (2003 and later) can resolve modules
                    down to 1 pixels it is recommended that for inkjet printers a module width of >=
                    2 is used. </para>
                <para>For Postcript backend the module width specified the width in Postscript
                    points (1 point = 1/72 inch).</para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>$backend->SetModuleWidth(2);</programlisting>
                </para>
                <para>
                    <tip>
                        <para>The size of the barcode image can be fine tuned by applying an overall
                            scaling constant as specified with the method
                            <code>SetScale()</code>.</para>
                    </tip>
                </para>
            </sect3>
            <sect3>
                <title>SetHeight</title>
                <para><code>SetHeight($aHeight)</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>Specified the height to width ratio for the individual rows in the barcode. By
                    default the ratio is 3, which means that the height of the rows in the barcode
                    is 3 times the module width. Most scanners can handle a factor between 2-5. You
                    should very rarely have to change this parameter. </para>
                <para>The ratio is specified as an integer. </para>
                <para>One reason to change this to a smaller value is to make a barcode label take
                    up less vertical space.</para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>$backend->SetHeight(2);</programlisting>
                </para>
                <para>
                    <caution>
                        <para>Not all barcode scanners are good at handling very small ratios. This
                            will also make the barcode more susceptible to damages.</para>
                    </caution>
                </para>
            </sect3>
            <sect3>
                <title>SetColor</title>
                <para><code>SetColor($aFrgColor,$aBkgColor)</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>Specify the foreground and background color for the barcode. </para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>$backend->SetColor( 'black', 'lightyellow');</programlisting>
                </para>
            </sect3>
            <sect3>
                <title> ShowFrame</title>
                <para><code>ShowFrame($aFlg=true)</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>Draw a 1 pixel frame around the barcode. This is not recommended in production
                    since it might disturb some scanners reading. This is only useful if you need a
                    visual feedback on the boundaries for the image. </para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>backend->SetFrame();</programlisting>
                </para>
            </sect3>
            <sect3>
                <title>ShowText</title>
                <para><code>ShowText($aFlg=true)</code></para>
                <para>
                    <caution>
                        <para>This is an extension specific to JpGraph. Human readable text is not
                            part of the official PDF417 standard and hence this is disabled by
                            default.. There are usually no problems of including this text but it is
                            not recommended to do so in a production environment. This is mostly
                            useful when debugging an application and to make it easer to see that
                            the correct data is encoded as a barcode label.</para>
                    </caution>
                </para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>Show human readable text of the encoded data underneath the barcode label. </para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting/>
                </para>
            </sect3>
            <sect3>
                <title>SetFont</title>
                <para><code>SetFont($aFontFam,$aFontStyle,$aFontSize)</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para> Specify the font for the human readable text underneath the barcode label. </para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>$backend->SetFont( FF_ARIAL, FS_NORMAL, 8); </programlisting>
                </para>
            </sect3>
        </sect2>
        <sect2>
            <title>Image backend methods</title>
            <sect3>
                <title> SetImgFormat</title>
                <para><code>SetImgFormat($aFormat)</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>Specify image format. Possible values are </para>
                <para>
                    <itemizedlist>
                        <listitem>
                            <para><code>'auto'</code></para>
                        </listitem>
                        <listitem>
                            <para><code>'png'</code></para>
                        </listitem>
                        <listitem>
                            <para><code>'jpeg'</code></para>
                        </listitem>
                        <listitem>
                            <para><code>'gif'</code></para>
                        </listitem>
                    </itemizedlist>
                </para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>$backend->SetImgFormat('jpeg');</programlisting>
                </para>
            </sect3>
        </sect2>
        <sect2>
            <title>Postscript backend methods</title>
            <para/>
            <sect3>
                <title>SetEPS($aFlg=true)</title>
                <para><code>SetEPS($aFlg=true)</code></para>
                <para><emphasis role="bold">Purpose:</emphasis></para>
                <para>Format the output as Encapsulated Postcript. This adds a bounding box
                    information to the output and makes this format suitable to be included in other
                    postscript files. </para>
                <para><emphasis role="bold">Example:</emphasis></para>
                <para>
                    <programlisting>$encoder = new PDF417Barcode( $columns, $errlevel);
$backend = PDF417BackendFactory::Create( BACKEND_PS, $encoder); 
$backend->SetEPS();</programlisting>
                </para>
            </sect3>
        </sect2>
    </sect1>
    <sect1>
        <title>Example scripts</title>
        <para>The following section shows some example scripts that can serve as starting points for
            further development. </para>
        <sect2>
            <title>Showing human readable text</title>
            <para>
                <programlisting>#pdf417_ex3|Showing human readable text#</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Altering colors</title>
            <para>
                <programlisting>#pdf417_ex4|Changing colors#</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Creating postscript output</title>
            <para>
                <programlisting>#:pdf417_ex5#</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Manually selecting compaction schema</title>
            <para><emphasis role="bold">Purpose:</emphasis></para>
            <para>To show how to manually specify the compaction schema to be used for the input
                data. The example below shows how to manually specify when to use numeric and when
                to use text mode. </para>
            <para>
                <programlisting>#pdf417_ex6#</programlisting>
            </para>
        </sect2>
    </sect1>
</chapter>
