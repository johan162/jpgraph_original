<?xml version="1.0" encoding="UTF-8"?>
<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbookxi.rng" type="xml"?>
<chapter version="5.0" xmlns="http://docbook.org/ns/docbook"
    xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>QR (2D-Barcode)</title>
    <sect1>
        <title>Principle of QR Barcodes</title>
        <note><para>This module is only available in the pro-version of the library.</para></note>
        <para>QR is currently the highest capacity general two-dimensional matrix symbology
            available (up to ~7Kb numeric data can be encoded) and it is designed to encode the full
            256 byte ASCII character set as well as the Kanji (Shift-JIS character set). QR code
            belongs to the modern 2 dimensional codes that is designed for both high capacity as
            well as to be efficient for scanner equipment to process and this is also the reason for
            its name - Quick Response code.</para>
        <para>An advantage with QR code is also there relatively small size for a given amount of
            information </para>
        <para>The QR code is available in 40 different square sizes each with a user selectable
            error correction level in four steps (referred to as error correction level L,M,Q and
            H). With the highest level of error correction used up to ~30% of the codewords can be
            damaged and still be restored.</para>
        <para>QR code is extensively used in some Asian countries and is finding more an more usage
            to transfer medium sized information onto mobile phones where the QR codes are
            interpretated by first taking a photo of the barcode with the mobile and then running a
            QR decoding program on the cell phone. This has currently become the most expansive
            usage of QR codes and some mobile manufactures are providing software to aid in
            interpreting QR codes for free.</para>
        <para>
            <note>
                <para>QR codes are also finding there way into public information sharing. For
                    example in Texas in US some cities are using QR codes to display public
                    information.</para>
            </note>
        </para>
        <para>
            <note>
                <para>QR Codes can be freely used without royalties. QR Codes are copyrighted
                    by:</para>
                <para>
                    <uri xlink:href="http://www.denso-wave.com">DENSO WAVE NCORPORATED</uri>.</para>
            </note>
        </para>
        <para>In <xref xlink:href="#fig.qr-structure-detailed"/> we have amended a large version of
            a basic QR code. In this figure the special finding patterns and timing patterns have
            been highlighted in red and blue. </para>
        <figure xml:id="fig.qr-structure-detailed">
            <title>QR Code high level structure</title>
            <mediaobject>
                <imageobject><imagedata fileref="images/qr-structure-details.png" scale="60"/></imageobject>
            </mediaobject>
        </figure>
        <para>The images below shows some real-life creative use of QR barcodes.</para>
        <para>
            <figure>
                <title>Creative usage of QR Barcodes</title>
                <informaltable frame="none">
                    <tgroup cols="3">
                        <colspec colname="c1" colnum="1"/>
                        <colspec colname="c2" colnum="2"/>
                        <colspec colname="c3" colnum="3"/>
                        <tbody>
                            <row>
                                <entry valign="bottom"><inlinemediaobject><imageobject><imagedata scale="60"
                                                fileref="images/qr_usage1.jpg"
                                        /></imageobject></inlinemediaobject></entry>
                                <entry valign="bottom"><inlinemediaobject><imageobject><imagedata scale="60"
                                                fileref="images/qr_usage2.jpg"
                                        /></imageobject></inlinemediaobject></entry>
                                <entry valign="bottom"><inlinemediaobject><imageobject><imagedata scale="60"
                                                fileref="images/qr_usage3.jpg"
                                        /></imageobject></inlinemediaobject></entry>
                            </row>
                        </tbody>
                    </tgroup>
                </informaltable>
            </figure>
        </para>
        <sect2>
            <title>Summary of library features</title>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>Output format</para>
                        <para>
                            <orderedlist>
                                <listitem>
                                    <para>Image format</para>
                                </listitem>
                                <listitem>
                                    <para>Postscript and encapsulated postscript</para>
                                </listitem>
                                <listitem>
                                    <para>ASCII</para>
                                </listitem>
                            </orderedlist>
                        </para>
                    </listitem>
                    <listitem>
                        <para>Encodation formats</para>
                        <para>
                            <orderedlist>
                                <listitem>
                                    <para>Numeric</para>
                                </listitem>
                                <listitem>
                                    <para>Alphanumeric</para>
                                </listitem>
                                <listitem>
                                    <para>Binary</para>
                                </listitem>
                            </orderedlist>
                        </para>
                    </listitem>
                    <listitem>
                        <para>Supports all specified symbol sizes</para>
                    </listitem>
                    <listitem>
                        <para>Supports both auto and user selectable encodation </para>
                    </listitem>
                    <listitem>
                        <para>Supports both auto and user selectable symbol size </para>
                    </listitem>
                    <listitem>
                        <para>Supports user specified module size </para>
                    </listitem>
                    <listitem>
                        <para>Supports custom color specification (foreground, background) </para>
                    </listitem>
                    <listitem>
                        <para>Symbols can be written directly to a file or sent back as an image to
                            the browser </para>
                    </listitem>
                </itemizedlist>
            </para>
        </sect2>
        <sect2>
            <title>Limitation in the JpGraph QR implementation</title>
            <para>This implementation is a faithful implementation of the ISO/IEC 18004E
                International Standard with one important exception. Version 1.0 does not support
                the encoding of 2 byte Shift-JIS character set. This means that two byte Kanji can
                only be encoded using binary data format which is less efficient than the native
                Kanji encoding. </para>
            <para>
                <caution>
                    <para>The computational complexity of the encodation process makes QR code
                        generation slightly slower than both PDF417 and Datamatrix. The technical
                        reason for most of the time is the final necessary evaluation of a bitmap
                        mask which is chosen to give as close to 50% mix of black and white areas in
                        the code as possible. Unfortunately this evaluation take time proportional
                        to the square of the size of the matrix. This time can be noticeable when
                        using "large" symbol sizes. There are existing QR code libraries that cheat
                        on this final step and just randomly selects a bit mask to avoid this
                        computational intensive evaluation. This is also the cause for the visual
                        difference between this libraries final result and some other. </para>
                    <para>In this case we claim that this library implements the proper standard
                        much more faithfully than some other libraries that exists.</para>
                </caution>
            </para>
        </sect2>
        <sect2>
            <title>QR Standard</title>
            <para>The QR code standard is fully described in the ISO/IEC 18004E International
                Standard and is available for purchase from the <uri
                    xlink:href="http://www.iso.ch/iso/en/CombinedQueryResult.CombinedQueryResult?queryString=qr"
                    >ISO Standard Organization</uri>. for a nominal fee.</para>
        </sect2>
        <sect2>
            <title>Structure and capacity of QR barcodes</title>
            <para>All QR barcode have square layout made up of equal spaced square modules.
                Depending on the size of the QR code a certain number of finder patterns are
                included in the code to aid in scanner decoding. The standard specifies 40 versions
                (sizes) of the QR code from the smallest 21x21 up to 177x177 modules in size. </para>
            <para>Examples of two basic QR codes are shown in <xref xlink:href="#fig.qr-code-small"
                /> and <xref xlink:href="#fig.qr-code-medium"/></para>
            <para>
                <informaltable frame="none">
                    <tgroup cols="2">
                        <colspec colname="c1" colnum="1"/>
                        <colspec colname="c2" colnum="2"/>
                        <tbody>
                            <row>
                                <entry valign="top">
                                    <figure xml:id="fig.qr-code-small">
                                        <title>A small sized QR Code (version=2) </title>
                                        <mediaobject>
                                            <imageobject>
                                                <imagedata fileref="images/qr-code-small.png" scale="60"/>
                                            </imageobject>
                                        </mediaobject>
                                    </figure>
                                </entry>
                                <entry valign="top">
                                    <figure xml:id="fig.qr-code-medium">
                                        <title>A medium sized QR code (version=13)</title>
                                        <mediaobject>
                                            <imageobject>
                                                <imagedata fileref="images/qr-code-medium.png" scale="60"/>
                                            </imageobject>
                                        </mediaobject>
                                    </figure>
                                </entry>
                            </row>
                        </tbody>
                    </tgroup>
                </informaltable>
            </para>
            <para>Depending on the actual data there are several compaction schema that can be used
                in order to achieve the greatest possible compression. The standard specifies four
                different principal schema, Numeric, Alphanumeric, Binary and Kanji. </para>
            <para>Depending on the application the user of the library may chose to either select a
                fixed encodation mode or let the library automatically chose the most efficient
                encodation method. It is usually best to let the library automatically select a
                combination of encodation schema that will give the smallest possible symbol size. </para>
            <para>The maximum capacity for QR codes dependent on the encodation schema (using the
                lowest possible error correction overhead) are given in <xref
                    xlink:href="#table.qr-capacity"/></para>
            <para>
                <table frame="all" xml:id="table.qr-capacity">
                    <title>QR Data capacity</title>
                    <tgroup cols="2">
                        <colspec colname="c1" colnum="1" colwidth="124.65pt"/>
                        <colspec colname="c2" colnum="2" colwidth="256.26pt"/>
                        <thead>
                            <row>
                                <entry>Encoding mode</entry>
                                <entry>Maximum capacity</entry>
                            </row>
                        </thead>
                        <tbody>
                            <row>
                                <entry>Numeric</entry>
                                <entry>7089 digits (Datamatrix=3116)</entry>
                            </row>
                            <row>
                                <entry>Alphanumeric</entry>
                                <entry>4296 characters (Datamatrix=2335)</entry>
                            </row>
                            <row>
                                <entry>Binary</entry>
                                <entry>2953 (Datamatrix=1555)</entry>
                            </row>
                            <row>
                                <entry>Kanji</entry>
                                <entry>1817 (Datamatrix NA)</entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
            </para>
            <para>The exact number of characters that can fit in a QR symbol depends on the actual
                encoding (or compaction) schema used. In short this is used to more efficiently
                encode ASCII characters to fit more data into a fixed number of bytes. For example
                if only numeric data is to be encoded then instead of using one byte to hold each
                digit three digits is stored in 10 bits. Which gives the equivalent capacity that 12
                digits takes only 5 bytes to encode. </para>
            <para>To encode data into a QR symbol the following principal steps are taken. </para>
            <para>
                <orderedlist>
                    <listitem>
                        <para>The input string (which can be any ASCII values between 0-255) is
                            encoded using the selected encoding or encodings (it is possible to
                            switch encoding mid-way through the string). The primary purpose of the
                            encoding is to compress the data into a much shorter form. </para>
                    </listitem>
                    <listitem>
                        <para>If needed the data is padded to fill up to the capacity of the
                            selected symbol size. </para>
                    </listitem>
                    <listitem>
                        <para>Once the string has been encoded (and possible padded) a number of
                            error correcting code words are added so that the data can be recovered
                            even if part of the printed symbol have been destroyed (perhaps a corner
                            has been teared off). </para>
                    </listitem>
                    <listitem>
                        <para>Finally the encoded data and the error correcting words are placed in
                            the symbol according to an algorithm specified in the standard. This is
                            done by placing each bit of every data byte in a specific position in
                            the qr matrix symbol.</para>
                    </listitem>
                </orderedlist>
            </para>
            <para>The above explanation is by necessity simplified and for those interested into the
                specific details we refer to the official standard. It is also possible to review
                the code itself to understand the details. </para>
        </sect2>
        <sect2>
            <title>QR versions and symbol size</title>
            <para>As mentioned in the previous section the QR standard specifies 40 different sizes
                of the QR code and the maximum data capacity will also vary depending on the size.
                    <xref xlink:href="#table.qr-symbol-sizes"/> shows the defined sizes and for each
                size specifies the possible Error correction levels and the maximum data capacity
                depending on the compaction schema used.</para>
            <para>By default the symbol size will be chosen as the smallest possible. However some
                application require that usage of a fixed size symbol. The symbol size is a
                parameter of the encodation schema and is adjusted in the creation of the
                    <code>QREncoder.</code>
            </para>
            <table frame="void" xml:id="table.qr-symbol-sizes" cellspacing="0" class="bdtable"
                width="700">
                <caption style="font-weight:bold;margin-bottom:10px;">Maximum data capacity for the
                    different symbol sizes in the QR-code.</caption>
                <col width="1.29*"/>
                <col width="1.45*"/>
                <col width="1.74*"/>
                <col width="1.45*"/>
                <col width="1.43*"/>
                <col width="2.26*"/>
                <col width="1.14*"/>
                <col width="1.0*"/>
                <thead>
                    <tr class="bdhdr">
                        <th class="bdur2">Version</th>
                        <th class="bdur2">Modules</th>
                        <th class="bdur2">ECC Level</th>
                        <th class="bdur2">Data bits</th>
                        <th class="bdur2">Numeric</th>
                        <th class="bdur2">Alphanumeric</th>
                        <th class="bdur2">Binary</th>
                        <th class="bdu2">Kanji</th>
                    </tr>
                </thead>
                <tbody>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">1</td>
                        <td rowspan="4" class="bdur2">21x21</td>
                        <td class="bdur">L</td>
                        <td class="bdur">152</td>
                        <td class="bdur">41</td>
                        <td class="bdur">25</td>
                        <td class="bdur">17</td>
                        <td class="bdu">10</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">128</td>
                        <td class="bdur">34</td>
                        <td class="bdur">20</td>
                        <td class="bdur">14</td>
                        <td class="bdu">8</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">104</td>
                        <td class="bdur">27</td>
                        <td class="bdur">16</td>
                        <td class="bdur">11</td>
                        <td class="bdu">7</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">72</td>
                        <td class="bdur2">17</td>
                        <td class="bdur2">10</td>
                        <td class="bdur2">7</td>
                        <td class="bdu2">4</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 2</td>
                        <td rowspan="4" class="bdur2"> 25x25</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 272</td>
                        <td class="bdur"> 77</td>
                        <td class="bdur"> 47</td>
                        <td class="bdur"> 32</td>
                        <td class="bdu"> 20</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 224</td>
                        <td class="bdur"> 63</td>
                        <td class="bdur"> 38</td>
                        <td class="bdur"> 26</td>
                        <td class="bdu"> 16</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 176</td>
                        <td class="bdur"> 48</td>
                        <td class="bdur"> 29</td>
                        <td class="bdur"> 20</td>
                        <td class="bdu"> 12</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 128</td>
                        <td class="bdur2"> 34</td>
                        <td class="bdur2"> 20</td>
                        <td class="bdur2"> 14</td>
                        <td class="bdu2"> 8</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">3</td>
                        <td rowspan="4" class="bdur2">29x29</td>
                        <td class="bdur">L</td>
                        <td class="bdur">440</td>
                        <td class="bdur">127</td>
                        <td class="bdur">77</td>
                        <td class="bdur">53</td>
                        <td class="bdu">32</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">352</td>
                        <td class="bdur">101</td>
                        <td class="bdur">61</td>
                        <td class="bdur">42</td>
                        <td class="bdu">26</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">272</td>
                        <td class="bdur">77</td>
                        <td class="bdur">47</td>
                        <td class="bdur">32</td>
                        <td class="bdu">20</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">208</td>
                        <td class="bdur2">58</td>
                        <td class="bdur2">35</td>
                        <td class="bdur2">24</td>
                        <td class="bdu2">15</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 4</td>
                        <td rowspan="4" class="bdur2"> 33x33</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 640</td>
                        <td class="bdur"> 187</td>
                        <td class="bdur"> 114</td>
                        <td class="bdur"> 78</td>
                        <td class="bdu"> 48</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 512</td>
                        <td class="bdur"> 149</td>
                        <td class="bdur"> 90</td>
                        <td class="bdur"> 62</td>
                        <td class="bdu"> 38</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 384</td>
                        <td class="bdur"> 111</td>
                        <td class="bdur"> 67</td>
                        <td class="bdur"> 46</td>
                        <td class="bdu"> 28</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 288</td>
                        <td class="bdur2"> 82</td>
                        <td class="bdur2"> 50</td>
                        <td class="bdur2"> 34</td>
                        <td class="bdu2"> 21</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">5</td>
                        <td rowspan="4" class="bdur2">37x37</td>
                        <td class="bdur">L</td>
                        <td class="bdur">864</td>
                        <td class="bdur">255</td>
                        <td class="bdur">154</td>
                        <td class="bdur">106</td>
                        <td class="bdu">65</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">688</td>
                        <td class="bdur">202</td>
                        <td class="bdur">122</td>
                        <td class="bdur">84</td>
                        <td class="bdu">52</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">496</td>
                        <td class="bdur">144</td>
                        <td class="bdur">87</td>
                        <td class="bdur">60</td>
                        <td class="bdu">37</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">368</td>
                        <td class="bdur2">106</td>
                        <td class="bdur2">64</td>
                        <td class="bdur2">44</td>
                        <td class="bdu2">27</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 6</td>
                        <td rowspan="4" class="bdur2"> 41x41</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 1,088</td>
                        <td class="bdur"> 322</td>
                        <td class="bdur"> 195</td>
                        <td class="bdur"> 134</td>
                        <td class="bdu"> 82</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 864</td>
                        <td class="bdur"> 255</td>
                        <td class="bdur"> 154</td>
                        <td class="bdur"> 106</td>
                        <td class="bdu"> 65</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 608</td>
                        <td class="bdur"> 178</td>
                        <td class="bdur"> 108</td>
                        <td class="bdur"> 74</td>
                        <td class="bdu"> 45</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 480</td>
                        <td class="bdur2"> 139</td>
                        <td class="bdur2"> 84</td>
                        <td class="bdur2"> 58</td>
                        <td class="bdu2"> 36</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">7</td>
                        <td rowspan="4" class="bdur2">45x45</td>
                        <td class="bdur">L</td>
                        <td class="bdur">1,248</td>
                        <td class="bdur">370</td>
                        <td class="bdur">224</td>
                        <td class="bdur">154</td>
                        <td class="bdu">95</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">992</td>
                        <td class="bdur">293</td>
                        <td class="bdur">178</td>
                        <td class="bdur">122</td>
                        <td class="bdu">75</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">704</td>
                        <td class="bdur">207</td>
                        <td class="bdur">125</td>
                        <td class="bdur">86</td>
                        <td class="bdu">53</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">528</td>
                        <td class="bdur2">154</td>
                        <td class="bdur2">93</td>
                        <td class="bdur2">64</td>
                        <td class="bdu2">39</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 8</td>
                        <td rowspan="4" class="bdur2"> 49x49</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 1,552</td>
                        <td class="bdur"> 461</td>
                        <td class="bdur"> 279</td>
                        <td class="bdur"> 192</td>
                        <td class="bdu"> 118</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 1,232</td>
                        <td class="bdur"> 365</td>
                        <td class="bdur"> 221</td>
                        <td class="bdur"> 152</td>
                        <td class="bdu"> 93</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 880</td>
                        <td class="bdur"> 259</td>
                        <td class="bdur"> 157</td>
                        <td class="bdur"> 108</td>
                        <td class="bdu"> 66</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 688</td>
                        <td class="bdur2"> 202</td>
                        <td class="bdur2"> 122</td>
                        <td class="bdur2"> 84</td>
                        <td class="bdu2"> 52</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">9</td>
                        <td rowspan="4" class="bdur2">53x53</td>
                        <td class="bdur">L</td>
                        <td class="bdur">1,856</td>
                        <td class="bdur">552</td>
                        <td class="bdur">335</td>
                        <td class="bdur">230</td>
                        <td class="bdu">141</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">1,456</td>
                        <td class="bdur">432</td>
                        <td class="bdur">262</td>
                        <td class="bdur">180</td>
                        <td class="bdu">111</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">1,056</td>
                        <td class="bdur">312</td>
                        <td class="bdur">189</td>
                        <td class="bdur">130</td>
                        <td class="bdu">80</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">800</td>
                        <td class="bdur2">235</td>
                        <td class="bdur2">143</td>
                        <td class="bdur2">98</td>
                        <td class="bdu2">60</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 10</td>
                        <td rowspan="4" class="bdur2"> 57x57</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 2,192</td>
                        <td class="bdur"> 652</td>
                        <td class="bdur"> 395</td>
                        <td class="bdur"> 271</td>
                        <td class="bdu"> 167</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 1,728</td>
                        <td class="bdur"> 513</td>
                        <td class="bdur"> 311</td>
                        <td class="bdur"> 213</td>
                        <td class="bdu"> 131</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 1,232</td>
                        <td class="bdur"> 364</td>
                        <td class="bdur"> 221</td>
                        <td class="bdur"> 151</td>
                        <td class="bdu"> 93</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 976</td>
                        <td class="bdur2"> 288</td>
                        <td class="bdur2"> 174</td>
                        <td class="bdur2"> 119</td>
                        <td class="bdu2"> 74</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">11</td>
                        <td rowspan="4" class="bdur2">61x61</td>
                        <td class="bdur">L</td>
                        <td class="bdur">2,592</td>
                        <td class="bdur">772</td>
                        <td class="bdur">468</td>
                        <td class="bdur">321</td>
                        <td class="bdu">198</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">2,032</td>
                        <td class="bdur">604</td>
                        <td class="bdur">366</td>
                        <td class="bdur">251</td>
                        <td class="bdu">155</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">1,440</td>
                        <td class="bdur">427</td>
                        <td class="bdur">259</td>
                        <td class="bdur">177</td>
                        <td class="bdu">109</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">1,120</td>
                        <td class="bdur2">331</td>
                        <td class="bdur2">200</td>
                        <td class="bdur2">137</td>
                        <td class="bdu2">85</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 12</td>
                        <td rowspan="4" class="bdur2"> 65x65</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 2,960</td>
                        <td class="bdur"> 883</td>
                        <td class="bdur"> 535</td>
                        <td class="bdur"> 367</td>
                        <td class="bdu"> 226</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 2,320</td>
                        <td class="bdur"> 691</td>
                        <td class="bdur"> 419</td>
                        <td class="bdur"> 287</td>
                        <td class="bdu"> 177</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 1,648</td>
                        <td class="bdur"> 489</td>
                        <td class="bdur"> 296</td>
                        <td class="bdur"> 203</td>
                        <td class="bdu"> 125</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 1,264</td>
                        <td class="bdur2"> 374</td>
                        <td class="bdur2"> 227</td>
                        <td class="bdur2"> 155</td>
                        <td class="bdu2"> 96</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">13</td>
                        <td rowspan="4" class="bdur2">69x69</td>
                        <td class="bdur">L</td>
                        <td class="bdur">3,424</td>
                        <td class="bdur">1,022</td>
                        <td class="bdur">619</td>
                        <td class="bdur">425</td>
                        <td class="bdu">262</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">2,672</td>
                        <td class="bdur">796</td>
                        <td class="bdur">483</td>
                        <td class="bdur">331</td>
                        <td class="bdu">204</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">1,952</td>
                        <td class="bdur">580</td>
                        <td class="bdur">352</td>
                        <td class="bdur">241</td>
                        <td class="bdu">149</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">1,440</td>
                        <td class="bdur2">427</td>
                        <td class="bdur2">259</td>
                        <td class="bdur2">177</td>
                        <td class="bdu2">109</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 14</td>
                        <td rowspan="4" class="bdur2"> 73x73</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 3,688</td>
                        <td class="bdur"> 1,101</td>
                        <td class="bdur"> 667</td>
                        <td class="bdur"> 458</td>
                        <td class="bdu"> 282</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 2,920</td>
                        <td class="bdur"> 871</td>
                        <td class="bdur"> 528</td>
                        <td class="bdur"> 362</td>
                        <td class="bdu"> 223</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 2,088</td>
                        <td class="bdur"> 621</td>
                        <td class="bdur"> 376</td>
                        <td class="bdur"> 258</td>
                        <td class="bdu"> 159</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 1,576</td>
                        <td class="bdur2"> 468</td>
                        <td class="bdur2"> 283</td>
                        <td class="bdur2"> 194</td>
                        <td class="bdu2"> 120</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">15</td>
                        <td rowspan="4" class="bdur2">77x77</td>
                        <td class="bdur">L</td>
                        <td class="bdur">4,184</td>
                        <td class="bdur">1,250</td>
                        <td class="bdur">758</td>
                        <td class="bdur">520</td>
                        <td class="bdu">320</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">3,320</td>
                        <td class="bdur">991</td>
                        <td class="bdur">600</td>
                        <td class="bdur">412</td>
                        <td class="bdu">254</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">2,360</td>
                        <td class="bdur">703</td>
                        <td class="bdur">426</td>
                        <td class="bdur">292</td>
                        <td class="bdu">180</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">1,784</td>
                        <td class="bdur2">530</td>
                        <td class="bdur2">321</td>
                        <td class="bdur2">220</td>
                        <td class="bdu2">136</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 16</td>
                        <td rowspan="4" class="bdur2"> 81x81</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 4,712</td>
                        <td class="bdur"> 1,408</td>
                        <td class="bdur"> 854</td>
                        <td class="bdur"> 586</td>
                        <td class="bdu"> 361</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 3,624</td>
                        <td class="bdur"> 1,082</td>
                        <td class="bdur"> 656</td>
                        <td class="bdur"> 450</td>
                        <td class="bdu"> 277</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 2,600</td>
                        <td class="bdur"> 775</td>
                        <td class="bdur"> 470</td>
                        <td class="bdur"> 322</td>
                        <td class="bdu"> 198</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 2,024</td>
                        <td class="bdur2"> 602</td>
                        <td class="bdur2"> 365</td>
                        <td class="bdur2"> 250</td>
                        <td class="bdu2"> 154</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">17</td>
                        <td rowspan="4" class="bdur2">85x85</td>
                        <td class="bdur">L</td>
                        <td class="bdur">5,176</td>
                        <td class="bdur">1,548</td>
                        <td class="bdur">938</td>
                        <td class="bdur">644</td>
                        <td class="bdu">397</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">4,056</td>
                        <td class="bdur">1,212</td>
                        <td class="bdur">734</td>
                        <td class="bdur">504</td>
                        <td class="bdu">310</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">2,936</td>
                        <td class="bdur">876</td>
                        <td class="bdur">531</td>
                        <td class="bdur">364</td>
                        <td class="bdu">224</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">2,264</td>
                        <td class="bdur2">674</td>
                        <td class="bdur2">408</td>
                        <td class="bdur2">280</td>
                        <td class="bdu2">173</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 18</td>
                        <td rowspan="4" class="bdur2"> 89x89</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 5,768</td>
                        <td class="bdur"> 1,725</td>
                        <td class="bdur"> 1,046</td>
                        <td class="bdur"> 718</td>
                        <td class="bdu"> 442</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 4,504</td>
                        <td class="bdur"> 1,346</td>
                        <td class="bdur"> 816</td>
                        <td class="bdur"> 560</td>
                        <td class="bdu"> 345</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 3,176</td>
                        <td class="bdur"> 948</td>
                        <td class="bdur"> 574</td>
                        <td class="bdur"> 394</td>
                        <td class="bdu"> 243</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 2,504</td>
                        <td class="bdur2"> 746</td>
                        <td class="bdur2"> 452</td>
                        <td class="bdur2"> 310</td>
                        <td class="bdu2"> 191</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">19</td>
                        <td rowspan="4" class="bdur2">93x93</td>
                        <td class="bdur">L</td>
                        <td class="bdur">6,360</td>
                        <td class="bdur">1,903</td>
                        <td class="bdur">1,153</td>
                        <td class="bdur">792</td>
                        <td class="bdu">488</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">5,016</td>
                        <td class="bdur">1,500</td>
                        <td class="bdur">909</td>
                        <td class="bdur">624</td>
                        <td class="bdu">384</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">3,560</td>
                        <td class="bdur">1,063</td>
                        <td class="bdur">644</td>
                        <td class="bdur">442</td>
                        <td class="bdu">272</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">2,728</td>
                        <td class="bdur2">813</td>
                        <td class="bdur2">493</td>
                        <td class="bdur2">338</td>
                        <td class="bdu2">208</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 20</td>
                        <td rowspan="4" class="bdur2"> 97x97</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 6,888</td>
                        <td class="bdur"> 2,061</td>
                        <td class="bdur"> 1,249</td>
                        <td class="bdur"> 858</td>
                        <td class="bdu"> 528</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 5,352</td>
                        <td class="bdur"> 1,600</td>
                        <td class="bdur"> 970</td>
                        <td class="bdur"> 666</td>
                        <td class="bdu"> 410</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 3,880</td>
                        <td class="bdur"> 1,159</td>
                        <td class="bdur"> 702</td>
                        <td class="bdur"> 482</td>
                        <td class="bdu"> 297</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 3,080</td>
                        <td class="bdur2"> 919</td>
                        <td class="bdur2"> 557</td>
                        <td class="bdur2"> 382</td>
                        <td class="bdu2"> 235</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">21</td>
                        <td rowspan="4" class="bdur2">101x101</td>
                        <td class="bdur">L</td>
                        <td class="bdur">7,456</td>
                        <td class="bdur">2,232</td>
                        <td class="bdur">1,352</td>
                        <td class="bdur">929</td>
                        <td class="bdu">572</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">5,712</td>
                        <td class="bdur">1,708</td>
                        <td class="bdur">1,035</td>
                        <td class="bdur">711</td>
                        <td class="bdu">438</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">4,096</td>
                        <td class="bdur">1,224</td>
                        <td class="bdur">742</td>
                        <td class="bdur">509</td>
                        <td class="bdu">314</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">3,248</td>
                        <td class="bdur2">969</td>
                        <td class="bdur2">587</td>
                        <td class="bdur2">403</td>
                        <td class="bdu2">248</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 22</td>
                        <td rowspan="4" class="bdur2"> 105x105</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 8,048</td>
                        <td class="bdur"> 2,409</td>
                        <td class="bdur"> 1,460</td>
                        <td class="bdur"> 1,003</td>
                        <td class="bdu"> 618</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 6,256</td>
                        <td class="bdur"> 1,872</td>
                        <td class="bdur"> 1,134</td>
                        <td class="bdur"> 779</td>
                        <td class="bdu"> 480</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 4,544</td>
                        <td class="bdur"> 1,358</td>
                        <td class="bdur"> 823</td>
                        <td class="bdur"> 565</td>
                        <td class="bdu"> 348</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 3,536</td>
                        <td class="bdur2"> 1,056</td>
                        <td class="bdur2"> 640</td>
                        <td class="bdur2"> 439</td>
                        <td class="bdu2"> 270</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">23</td>
                        <td rowspan="4" class="bdur2">109x109</td>
                        <td class="bdur">L</td>
                        <td class="bdur">8,752</td>
                        <td class="bdur">2,620</td>
                        <td class="bdur">1,588</td>
                        <td class="bdur">1,091</td>
                        <td class="bdu">672</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">6,880</td>
                        <td class="bdur">2,059</td>
                        <td class="bdur">1,248</td>
                        <td class="bdur">857</td>
                        <td class="bdu">528</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">4,912</td>
                        <td class="bdur">1,468</td>
                        <td class="bdur">890</td>
                        <td class="bdur">611</td>
                        <td class="bdu">376</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">3,712</td>
                        <td class="bdur2">1,108</td>
                        <td class="bdur2">672</td>
                        <td class="bdur2">461</td>
                        <td class="bdu2">284</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 24</td>
                        <td rowspan="4" class="bdur2"> 113x113</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 9,392</td>
                        <td class="bdur"> 2,812</td>
                        <td class="bdur"> 1,704</td>
                        <td class="bdur"> 1,171</td>
                        <td class="bdu"> 721</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 7,312</td>
                        <td class="bdur"> 2,188</td>
                        <td class="bdur"> 1,326</td>
                        <td class="bdur"> 911</td>
                        <td class="bdu"> 561</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 5,312</td>
                        <td class="bdur"> 1,588</td>
                        <td class="bdur"> 963</td>
                        <td class="bdur"> 661</td>
                        <td class="bdu"> 407</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 4,112</td>
                        <td class="bdur2"> 1,228</td>
                        <td class="bdur2"> 744</td>
                        <td class="bdur2"> 511</td>
                        <td class="bdu2"> 315</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">25</td>
                        <td rowspan="4" class="bdur2">117x117</td>
                        <td class="bdur">L</td>
                        <td class="bdur">10,208</td>
                        <td class="bdur">3,057</td>
                        <td class="bdur">1,853</td>
                        <td class="bdur">1,273</td>
                        <td class="bdu">784</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">8,000</td>
                        <td class="bdur">2,395</td>
                        <td class="bdur">1,451</td>
                        <td class="bdur">997</td>
                        <td class="bdu">614</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">5,744</td>
                        <td class="bdur">1,718</td>
                        <td class="bdur">1,041</td>
                        <td class="bdur">715</td>
                        <td class="bdu">440</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">4,304</td>
                        <td class="bdur2">1,286</td>
                        <td class="bdur2">779</td>
                        <td class="bdur2">535</td>
                        <td class="bdu2">330</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 26</td>
                        <td rowspan="4" class="bdur2"> 121x121</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 10,960</td>
                        <td class="bdur"> 3,283</td>
                        <td class="bdur"> 1,990</td>
                        <td class="bdur"> 1,367</td>
                        <td class="bdu"> 842</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 8,496</td>
                        <td class="bdur"> 2,544</td>
                        <td class="bdur"> 1,542</td>
                        <td class="bdur"> 1,059</td>
                        <td class="bdu"> 652</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 6,032</td>
                        <td class="bdur"> 1,804</td>
                        <td class="bdur"> 1,094</td>
                        <td class="bdur"> 751</td>
                        <td class="bdu"> 462</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 4,768</td>
                        <td class="bdur2"> 1,425</td>
                        <td class="bdur2"> 864</td>
                        <td class="bdur2"> 593</td>
                        <td class="bdu2"> 365</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">27</td>
                        <td rowspan="4" class="bdur2">125x125</td>
                        <td class="bdur">L</td>
                        <td class="bdur">11,744</td>
                        <td class="bdur">3,514</td>
                        <td class="bdur">2,132</td>
                        <td class="bdur">1,465</td>
                        <td class="bdu">902</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">9,024</td>
                        <td class="bdur">2,701</td>
                        <td class="bdur">1,637</td>
                        <td class="bdur">1,125</td>
                        <td class="bdu">692</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">6,464</td>
                        <td class="bdur">1,933</td>
                        <td class="bdur">1,172</td>
                        <td class="bdur">805</td>
                        <td class="bdu">496</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">5,024</td>
                        <td class="bdur2">1,501</td>
                        <td class="bdur2">910</td>
                        <td class="bdur2">625</td>
                        <td class="bdu2">385</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 28</td>
                        <td rowspan="4" class="bdur2"> 129x129</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 12,248</td>
                        <td class="bdur"> 3,669</td>
                        <td class="bdur"> 2,223</td>
                        <td class="bdur"> 1,528</td>
                        <td class="bdu"> 940</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 9,544</td>
                        <td class="bdur"> 2,857</td>
                        <td class="bdur"> 1,732</td>
                        <td class="bdur"> 1,190</td>
                        <td class="bdu"> 732</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 6,968</td>
                        <td class="bdur"> 2,085</td>
                        <td class="bdur"> 1,263</td>
                        <td class="bdur"> 868</td>
                        <td class="bdu"> 534</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 5,288</td>
                        <td class="bdur2"> 1,581</td>
                        <td class="bdur2"> 958</td>
                        <td class="bdur2"> 658</td>
                        <td class="bdu2"> 405</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">29</td>
                        <td rowspan="4" class="bdur2">133x133</td>
                        <td class="bdur">L</td>
                        <td class="bdur">13,048</td>
                        <td class="bdur">3,909</td>
                        <td class="bdur">2,369</td>
                        <td class="bdur">1,628</td>
                        <td class="bdu">1,002</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">10,136</td>
                        <td class="bdur">3,035</td>
                        <td class="bdur">1,839</td>
                        <td class="bdur">1,264</td>
                        <td class="bdu">778</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">7,288</td>
                        <td class="bdur">2,181</td>
                        <td class="bdur">1,322</td>
                        <td class="bdur">908</td>
                        <td class="bdu">559</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">5,608</td>
                        <td class="bdur2">1,677</td>
                        <td class="bdur2">1,016</td>
                        <td class="bdur2">698</td>
                        <td class="bdu2">430</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 30</td>
                        <td rowspan="4" class="bdur2"> 137x137</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 13,880</td>
                        <td class="bdur"> 4,158</td>
                        <td class="bdur"> 2,520</td>
                        <td class="bdur"> 1,732</td>
                        <td class="bdu"> 1,066</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 10,984</td>
                        <td class="bdur"> 3,289</td>
                        <td class="bdur"> 1,994</td>
                        <td class="bdur"> 1,370</td>
                        <td class="bdu"> 843</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 7,880</td>
                        <td class="bdur"> 2,358</td>
                        <td class="bdur"> 1,429</td>
                        <td class="bdur"> 982</td>
                        <td class="bdu"> 604</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 5,960</td>
                        <td class="bdur2"> 1,782</td>
                        <td class="bdur2"> 1,080</td>
                        <td class="bdur2"> 742</td>
                        <td class="bdu2"> 457</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">31</td>
                        <td rowspan="4" class="bdur2">141x141</td>
                        <td class="bdur">L</td>
                        <td class="bdur">14,744</td>
                        <td class="bdur">4,417</td>
                        <td class="bdur">2,677</td>
                        <td class="bdur">1,840</td>
                        <td class="bdu">1132</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">11,640</td>
                        <td class="bdur">3,486</td>
                        <td class="bdur">2,113</td>
                        <td class="bdur">1,452</td>
                        <td class="bdu">894</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">8,264</td>
                        <td class="bdur">2,473</td>
                        <td class="bdur">1,499</td>
                        <td class="bdur">1,030</td>
                        <td class="bdu">634</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">6,344</td>
                        <td class="bdur2">1,897</td>
                        <td class="bdur2">1,150</td>
                        <td class="bdur2">790</td>
                        <td class="bdu2">486</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 32</td>
                        <td rowspan="4" class="bdur2"> 145x145</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 15,640</td>
                        <td class="bdur"> 4,686</td>
                        <td class="bdur"> 2,840</td>
                        <td class="bdur"> 1,952</td>
                        <td class="bdu"> 1,201</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 12,328</td>
                        <td class="bdur"> 3,693</td>
                        <td class="bdur"> 2,238</td>
                        <td class="bdur"> 1,538</td>
                        <td class="bdu"> 947</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 8,920</td>
                        <td class="bdur"> 2,670</td>
                        <td class="bdur"> 1,618</td>
                        <td class="bdur"> 1,112</td>
                        <td class="bdu"> 684</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 6,760</td>
                        <td class="bdur2"> 2,022</td>
                        <td class="bdur2"> 1,226</td>
                        <td class="bdur2"> 842</td>
                        <td class="bdu2"> 518</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">33</td>
                        <td rowspan="4" class="bdur2">149x149</td>
                        <td class="bdur">L</td>
                        <td class="bdur">16,568</td>
                        <td class="bdur">4,965</td>
                        <td class="bdur">3,009</td>
                        <td class="bdur">2,068</td>
                        <td class="bdu">1,273</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">13,048</td>
                        <td class="bdur">3,909</td>
                        <td class="bdur">2,369</td>
                        <td class="bdur">1,628</td>
                        <td class="bdu">1,002</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">9,368</td>
                        <td class="bdur">2,805</td>
                        <td class="bdur">1,700</td>
                        <td class="bdur">1,168</td>
                        <td class="bdu">719</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">7,208</td>
                        <td class="bdur2">2,157</td>
                        <td class="bdur2">1,307</td>
                        <td class="bdur2">898</td>
                        <td class="bdu2">553</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 34</td>
                        <td rowspan="4" class="bdur2"> 153x153</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 17,528</td>
                        <td class="bdur"> 5,253</td>
                        <td class="bdur"> 3,183</td>
                        <td class="bdur"> 2,188</td>
                        <td class="bdu"> 1,347</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 13,800</td>
                        <td class="bdur"> 4,134</td>
                        <td class="bdur"> 2,506</td>
                        <td class="bdur"> 1,722</td>
                        <td class="bdu"> 1,060</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 9,848</td>
                        <td class="bdur"> 2,949</td>
                        <td class="bdur"> 1,787</td>
                        <td class="bdur"> 1,228</td>
                        <td class="bdu"> 756</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 7,688</td>
                        <td class="bdur2"> 2,301</td>
                        <td class="bdur2"> 1,394</td>
                        <td class="bdur2"> 958</td>
                        <td class="bdu2"> 590</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">35</td>
                        <td rowspan="4" class="bdur2">157x157</td>
                        <td class="bdur">L</td>
                        <td class="bdur">18,448</td>
                        <td class="bdur">5,529</td>
                        <td class="bdur">3,351</td>
                        <td class="bdur">2,303</td>
                        <td class="bdu">1,417</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">14,496</td>
                        <td class="bdur">4,343</td>
                        <td class="bdur">2,632</td>
                        <td class="bdur">1,809</td>
                        <td class="bdu">1,113</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">10,288</td>
                        <td class="bdur">3,081</td>
                        <td class="bdur">1,867</td>
                        <td class="bdur">1,283</td>
                        <td class="bdu">790</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">7,888</td>
                        <td class="bdur2">2,361</td>
                        <td class="bdur2">1,431</td>
                        <td class="bdur2">983</td>
                        <td class="bdu2">605</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 36</td>
                        <td rowspan="4" class="bdur2"> 161x161</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 19,472</td>
                        <td class="bdur"> 5,836</td>
                        <td class="bdur"> 3,537</td>
                        <td class="bdur"> 2,431</td>
                        <td class="bdu"> 1,496</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 15,312</td>
                        <td class="bdur"> 4,588</td>
                        <td class="bdur"> 2,780</td>
                        <td class="bdur"> 1,911</td>
                        <td class="bdu"> 1,176</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 10,832</td>
                        <td class="bdur"> 3,244</td>
                        <td class="bdur"> 1,966</td>
                        <td class="bdur"> 1,351</td>
                        <td class="bdu"> 832</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 8,432</td>
                        <td class="bdur2"> 2,524</td>
                        <td class="bdur2"> 1,530</td>
                        <td class="bdur2"> 1,051</td>
                        <td class="bdu2"> 647</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">37</td>
                        <td rowspan="4" class="bdur2">165x165</td>
                        <td class="bdur">L</td>
                        <td class="bdur">20,528</td>
                        <td class="bdur">6,153</td>
                        <td class="bdur">3,729</td>
                        <td class="bdur">2,563</td>
                        <td class="bdu">1,577</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">15,936</td>
                        <td class="bdur">4,775</td>
                        <td class="bdur">2,894</td>
                        <td class="bdur">1,989</td>
                        <td class="bdu">1,224</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">11,408</td>
                        <td class="bdur">3,417</td>
                        <td class="bdur">2,071</td>
                        <td class="bdur">1,423</td>
                        <td class="bdu">876</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">8,768</td>
                        <td class="bdur2">2,625</td>
                        <td class="bdur2">1,591</td>
                        <td class="bdur2">1,093</td>
                        <td class="bdu2">673</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2"> 38</td>
                        <td rowspan="4" class="bdur2"> 169x169</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 21,616</td>
                        <td class="bdur"> 6,479</td>
                        <td class="bdur"> 3,927</td>
                        <td class="bdur"> 2,699</td>
                        <td class="bdu"> 1,661</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 16,816</td>
                        <td class="bdur"> 5,039</td>
                        <td class="bdur"> 3,054</td>
                        <td class="bdur"> 2,099</td>
                        <td class="bdu"> 1,292</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 12,016</td>
                        <td class="bdur"> 3,599</td>
                        <td class="bdur"> 2,181</td>
                        <td class="bdur"> 1,499</td>
                        <td class="bdu"> 923</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2"> H</td>
                        <td class="bdur2"> 9,136</td>
                        <td class="bdur2"> 2,735</td>
                        <td class="bdur2"> 1,658</td>
                        <td class="bdur2"> 1,139</td>
                        <td class="bdu2"> 701</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur2">39</td>
                        <td rowspan="4" class="bdur2">173x173</td>
                        <td class="bdur">L</td>
                        <td class="bdur">22,496</td>
                        <td class="bdur">6,743</td>
                        <td class="bdur">4,087</td>
                        <td class="bdur">2,809</td>
                        <td class="bdu">1,729</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">M</td>
                        <td class="bdur">17,728</td>
                        <td class="bdur">5,313</td>
                        <td class="bdur">3,220</td>
                        <td class="bdur">2,213</td>
                        <td class="bdu">1,362</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur">Q</td>
                        <td class="bdur">12,656</td>
                        <td class="bdur">3,791</td>
                        <td class="bdur">2,298</td>
                        <td class="bdur">1,579</td>
                        <td class="bdu">972</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur2">H</td>
                        <td class="bdur2">9,776</td>
                        <td class="bdur2">2,927</td>
                        <td class="bdur2">1,774</td>
                        <td class="bdur2">1,219</td>
                        <td class="bdu2">750</td>
                    </tr>
                    <tr align="center">
                        <td rowspan="4" class="bdur"> 40</td>
                        <td rowspan="4" class="bdur"> 177x177</td>
                        <td class="bdur"> L</td>
                        <td class="bdur"> 23,648</td>
                        <td class="bdur"> 7,089</td>
                        <td class="bdur"> 4,296</td>
                        <td class="bdur"> 2,953</td>
                        <td class="bdu"> 1,817</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> M</td>
                        <td class="bdur"> 18,672</td>
                        <td class="bdur"> 5,596</td>
                        <td class="bdur"> 3,391</td>
                        <td class="bdur"> 2,331</td>
                        <td class="bdu"> 1,435</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> Q</td>
                        <td class="bdur"> 13,328</td>
                        <td class="bdur"> 3,993</td>
                        <td class="bdur"> 2,420</td>
                        <td class="bdur"> 1,663</td>
                        <td class="bdu"> 1,024</td>
                    </tr>
                    <tr align="center">
                        <td class="bdur"> H</td>
                        <td class="bdur"> 10,208</td>
                        <td class="bdur"> 3,057</td>
                        <td class="bdur"> 1,852</td>
                        <td class="bdur"> 1,273</td>
                        <td class="bdu"> 784</td>
                    </tr>
                </tbody>
            </table>
        </sect2>
        <sect2>
            <title>Error correction level</title>
            <para>As shown in <xref xlink:href="#table.qr-symbol-sizes"/> the QR standard specifies
                four different error correction levels. In the library the error correction can
                either be set to be chosen automatically or specified manually. The properties of
                the available error correction levels are given in <xref
                    xlink:href="#table.qr-error-correction-levels"/>. The "<emphasis role="italic"
                    >Error correction capacity</emphasis>" column specifies how large percentage of
                the codewords that can be destroyed and the code still being decoded.</para>
            <para>
                <table frame="all" xml:id="table.qr-error-correction-levels">
                    <title>QR Error correction levels</title>
                    <tgroup cols="3">
                        <colspec colname="c1" colnum="1" colwidth="85.16pt"/>
                        <colspec colname="c2" colnum="2" colwidth="164.9pt"/>
                        <colspec colname="c3" colnum="3" colwidth="168.0pt"/>
                        <thead>
                            <row>
                                <entry align="center">Error level</entry>
                                <entry align="center">Symbolic constant</entry>
                                <entry align="center">Error correction capacity</entry>
                            </row>
                        </thead>
                        <tbody>
                            <row>
                                <entry align="center">L</entry>
                                <entry align="center"><code>QRCapacity::ErrL</code></entry>
                                <entry align="center">5 %</entry>
                            </row>
                            <row>
                                <entry align="center">M</entry>
                                <entry align="center"><code>QRCapacity::ErrM</code></entry>
                                <entry align="center">15 %</entry>
                            </row>
                            <row>
                                <entry align="center">Q</entry>
                                <entry align="center"><code>QRCapacity::ErrQ</code></entry>
                                <entry align="center">25 %</entry>
                            </row>
                            <row>
                                <entry align="center">H</entry>
                                <entry align="center"><code>QRCapacity::ErrH</code></entry>
                                <entry align="center">30 %</entry>
                            </row>
                        </tbody>
                    </tgroup>
                </table>
            </para>
        </sect2>
        <sect2>
            <title>Comparing the visual output with other QR-generating software</title>
            <para>It is possible that the JpGraph library gives a visually different result than
                some other available QR encoders. As a matter of fact many QR encoders gives a
                different visual result from the same input. This does not mean that one QR encoder
                is more correct than any other. This is a consequence of interpretation of the
                standard in a way that (without going into technical details) does not in any way
                affect the decoding of the barcode. It only affects the visual appearance.</para>
            <para>
                <note>
                    <para>Part of the reason is that the original ISO/IEC 18004E standard is not
                        consistent between its theoretical description and the examples that is
                        given in the standard. For those interested in a more technically
                        explanation of these visual issues we refer to</para>
                    <para>
                        <itemizedlist>
                            <listitem>
                                <para>
                                    <uri xlink:href="http://www.aditus.nu/jpgraph/qr-comment.pdf">
                                        "A note on minor errors in the International QR Barcode
                                        standard"</uri> , 2008, J. Persson</para>
                            </listitem>
                        </itemizedlist>
                    </para>
                    <para>which gives a detailed analysis and explanation of these issues. </para>
                </note>
            </para>
        </sect2>
    </sect1>
    <sect1>
        <title>Creating barcodes</title>
        <para>In order to use QR codes the module "<filename>QR/qrencoder.inc.php</filename>" must
            first be included.</para>
        <para>Usage of QR codes follows a similar schema as for the linear, PDF417 and Datamatrix
            barcodes with the concepts of an encoder and backend. The principle of the overall
            encodation process is shown in <xref xlink:href="#fig.datamatrix-encodation-principle"
            /></para>
        <figure>
            <title>QR Encodation Process</title>
            <mediaobject>
                <imageobject><imagedata fileref="images/qr-encodation-principle.png" scale="60"/></imageobject>
            </mediaobject>
        </figure>
        <sect2>
            <title>Getting started</title>
            <para>In order to use the QR barcodes the library module
                    "<filename>QR/qrencoder.inc.php</filename>" must first be included in the
                script.</para>
            <para>
                <orderedlist>
                    <listitem>
                        <para>Create an instance of the encoder and optionally specify size and
                            error correction level. The encoder is created as an instance of
                                <code>class QREncoder</code></para>
                    </listitem>
                    <listitem>
                        <para>Create an instance of a suitable backend for the chosen output format
                            (image or postscript) by calling the
                                <code>DatamatrixBackenFactory::Create()</code></para>
                    </listitem>
                    <listitem>
                        <para>Encode data and send it back to the browser or to a file with a call
                            to the backend <code>Backend::Stroke()</code> method.</para>
                    </listitem>
                </orderedlist>
            </para>
            <para>The following script shows how to create the simplest possible QR code (in PNG
                format) representing the data string "<code>The first QR code</code>" encoded using
                all default values. The resulting QR Code is shown in <xref
                    xlink:href="#fig.qrexample00"/></para>
            <para>
                <programlisting>#qrexample00|The first very basic QR code#</programlisting>
            </para>
            <para>(As can be seen this follows the same principles as the creation of Datamatrix
                symbols)</para>
            <para>The principle is the same for all type of data QR code creations. First an
                instance of the chosen encoder is instantiated. In this case using all default
                parameters by creating an instance of <code>class QREncoder</code>. We then create a
                suitable backend that handles the output of the barcode. By default the output will
                be an image encoded in the PNG image format.</para>
            <para>The final step is to send back the generated image to the browser with a call to
                the method <code>Backend::Stroke()</code> with the data to be encoded as its first
                argument.</para>
            <para>The example above does not have any error handling. If there is some error in the
                process an exception will be thrown in the same way as in other places in the
                library. The default exception will display a standard library image error box. An
                example of this is shown in <xref xlink:href="#fig.qr-errmsg"/></para>
            <figure xml:id="fig.qr-errmsg">
                <title>QR Error message</title>
                <mediaobject>
                    <imageobject><imagedata fileref="images/qr_errmsg.png" scale="60"/></imageobject>
                </mediaobject>
            </figure>
            <para>If some additional processing is necessary and to just display a text based
                re-formatted error message we could change the above code to catch this exception as
                the following example shows.</para>
            <para>
                <programlisting>#qrexample0|Adding basic exception handling#</programlisting>
            </para>
            <para>As a final initial example the next script uses the backend method
                    <code>Backend::SetModuleWidth($aWidth)</code> to increase the size of one
                module. Since a module in QR code refers to the smallest square used adjusting the
                module width will also adjust the height of the overall QR code</para>
            <para>
                <programlisting>#qrexample01|Adjusting the module width for the QR code#</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Error handling</title>
            <para>As in other parts of the library the QR module throws an exception when an error
                occurs. As shown in the previous section an error image is the default if no
                explicit <code>try {} catch {}</code> statement is added to the script.</para>
            <para>
                <note>
                    <para>The fact that an image is shown as the default exception is caused by the
                        library module "qrexception.inc.php" installing its own default error
                        handler which will be called when an exception happens. However, this
                        handler is intelligent enough to know if the exception is caused by the
                        library or not. If the exception is not caused by the library the exception
                        is re-thrown and the original error handler restored. This means that
                        JpGraph will not interfere with previously installed error handlers for
                        other parts of an application.</para>
                </note>
            </para>
            <para>The script below shows how to catch the error, do some possible clean up and then
                explicitly create and send back the error image.</para>
            <para>
                <programlisting>&lt;?php
...
try {
    $backend->Stroke($data);
} catch( Exception $e ) {
    doCleanup();
    $errobj = new QRErrObjectImg();
    $errobj->Raise($e->getMessage());    
}
?></programlisting>
            </para>
            <para>another variant of this would be to re-throw the exception after the cleanup has
                been performed as the following example shows</para>
            <para>
                <programlisting>&lt;?php
...
try {
    $backend->Stroke($data);
} catch( Exception $e ) {
    doCleanup();
    throw $e;
}
?></programlisting>
            </para>
            <para>It is also possible to get hold of the internal error code that corresponds to
                each error message by calling the PHP standard exception method
                    <code>Exception::getCode()</code> as the following example shows</para>
            <para>
                <programlisting>&lt;?php
...
try {
    $backend->Stroke($data);
} catch (Exception $e) {
    $errstr = $e->GetMessage();
    $errcode = $e->GetCode();
    echo "QR error ($errcode). Message: $errstr\n";
}
?></programlisting>
            </para>
            <para><xref xlink:href="#table.qr-error-messages"/> lists the public errors that can be
                thrown by the QR code module (the table deliberately excludes internal error
                messages)</para>
            <table frame="all" xml:id="table.qr-error-messages">
                <title>QR Error messages</title>
                <tgroup cols="2">
                    <colspec colname="c1" colnum="1"/>
                    <colspec colname="c2" colnum="2"/>
                    <thead>
                        <row>
                            <entry align="center">Error number</entry>
                            <entry align="center">Error string</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry role="error-number" align="center">1000</entry>
                            <entry role="error-text">
                                <para>Tilde processing is not yet supported for QR Barcodes.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1001</entry>
                            <entry role="error-text">
                                <para>Inverting the bit pattern is not supported for QR
                                    Barcodes.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1002</entry>
                            <entry role="error-text">
                                <para>Cannot read data from file %s</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1003</entry>
                            <entry role="error-text">
                                <para>Cannot open file %s</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1004</entry>
                            <entry role="error-text">
                                <para>Cannot write QR barcode to file %s</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1005</entry>
                            <entry role="error-text">
                                <para>Unsupported image format selected. Check your GD
                                    installation</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1006</entry>
                            <entry role="error-text">
                                <para>Cannot set the selected barcode colors. Check your GD
                                    installation and spelling of color name</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1007</entry>
                            <entry role="error-text">
                                <para>QR Error: HTTP headers have already been sent.</para>
                                <para>Caused by output from file %s at line %d</para>
                                <para>Explanation: HTTP headers have already been sent back to the
                                    browser indicating the data as text before the library got a
                                    chance to send it's image HTTP header to this browser. This
                                    makes it impossible for the QR library to send back image data
                                    to the browser (since that would be interpretated as text by the
                                    browser and show up as junk text).</para>
                                <para>Most likely you have some text in your script before the call
                                    to QRBackend::Stroke(). </para>
                                <para>If this texts gets sent back to the browser the browser will
                                    assume that all data is plain text. Look for any text (even
                                    spaces and newlines) that might have been sent back to the
                                    browser.</para>
                                <para>For example it is a common mistake to leave a blank line
                                    before the opening "&lt;?php"</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1008</entry>
                            <entry role="error-text">
                                <para>Could not create the barcode image with image format=%s. Check
                                    your GD/PHP installation.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1009</entry>
                            <entry role="error-text">
                                <para>Cannot open log file %s for writing.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1010</entry>
                            <entry role="error-text">
                                <para>Cannot write log info to log file %s.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1011</entry>
                            <entry role="error-text">
                                <para>Could not write the QR Code to file. Check the file system
                                    permissions.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1400</entry>
                            <entry role="error-text">
                                <para>QR Version must be specified as a value in the range [1,40]
                                    got %d</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1401</entry>
                            <entry role="error-text">
                                <para>Input data to barcode can not be empty.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1402</entry>
                            <entry role="error-text">
                                <para>Automatic encodation mode was specified but input data looks
                                    like specification for manual encodation.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1403</entry>
                            <entry role="error-text">
                                <para>Was expecting an array of arrays as input data for manual
                                    encoding.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1404</entry>
                            <entry role="error-text">
                                <para>Each input data array element must consist of two entries.
                                    Element $i has of $nn entries</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1405</entry>
                            <entry role="error-text">
                                <para>Each input data array element must consist of two entries with
                                    first entry being the encodation constant and the second element
                                    the data string. Element %d is incorrect in this respect.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1406</entry>
                            <entry role="error-text">
                                <para>Was expecting either a string or an array as input data</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1407</entry>
                            <entry role="error-text">
                                <para>Manual encodation mode was specified but input data looks like
                                    specification for automatic encodation.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1408</entry>
                            <entry role="error-text">
                                <para>Input data too large to fit into one QR Symbol</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1409</entry>
                            <entry role="error-text">
                                <para>The selected symbol version %d is too small to fit the
                                    specified data and selected error correction level.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1410</entry>
                            <entry role="error-text">
                                <para>Trying to read past the last available codeword in block
                                    split.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1415</entry>
                            <entry role="error-text">
                                <para>Manually specified encodation schema MODE_NUMERIC has no data
                                    that can be encoded using this schema.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1416</entry>
                            <entry role="error-text">
                                <para>Manually specified encodation schema MODE_ALPHANUM has no data
                                    that can be encoded using this schema.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1417</entry>
                            <entry role="error-text">
                                <para>Manually specified encodation schema MODE_BYTE has no data
                                    that can be encoded using this schema.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1418</entry>
                            <entry role="error-text">
                                <para>Unsupported encodation schema specified (%d)</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1419</entry>
                            <entry role="error-text">
                                <para>Found character in data stream that cannot be encoded with the
                                    selected manual encodation mode.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1420</entry>
                            <entry role="error-text">
                                <para>Encodation using KANJI mode not yet supported.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1422</entry>
                            <entry role="error-text">
                                <para>Found unknown characters in the data stream that can't be
                                    encoded with any available encodation mode.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1423</entry>
                            <entry role="error-text">
                                <para>Kanji character set not yet supported.</para>
                            </entry>
                        </row>
                        <row>
                            <entry role="error-number" align="center">1427</entry>
                            <entry role="error-text">
                                <para>Expected either DIGIT, ALNUM or BYTE but found ASCII
                                    code=%d</para>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
        </sect2>
        <sect2>
            <title>Creating an encoder</title>
            <para>A QR encoder is created as an instance of <code>class QREncoder</code>. The
                constructor have the following signature</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para><code>QREncoder::__construct($aVersion = -1, $aErrLevel =
                                QRCapacity::ErrM)</code></para>
                        <para><code>$aVersion</code>, Specifies the QR version and is specified as
                            an integer in the range [1,40], see <xref
                                xlink:href="#table.qr-symbol-sizes"/>
                        </para>
                        <para><code>$aErrLevel</code>, Specifies the error correction level to be
                            used, see <xref xlink:href="#table.qr-error-correction-levels"/></para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>The following examples creates a basic encoder which will automatically select the
                smallest possible size to fit the data given</para>
            <para>
                <programlisting>$encoder = new QREncoder();</programlisting>
            </para>
            <para>The following example will create an instance of an encoder with size 22 and error
                correction level 'Q'</para>
            <para>
                <programlisting>$encoder = new QREncoder(22, QRCapacity::ErrQ);</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Encodation of input data options</title>
            <para>The absolute simplest way of encoding data is simply to create a simple string
                representing the data to be encoded and then pass that string as the first argument
                to the <code>Stroke()</code> method in the backend. The encoder will then analyze
                the input data and choose the most efficient space saving encoding schema for this
                data. </para>
            <para>
                <note>
                    <para>Unless there are some really good reasons to use manual encodation it
                        should be left to the library to determine this in an optimal way!</para>
                </note>
            </para>
            <para>The QR standard allows 3 different compaction schema that can be used to minimize
                the number of codewords used for a particular data string. This also means that a
                particular data string may have several different valid barcodes that visually looks
                different. </para>
            <para>The supported compaction modes in the library are:</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para><emphasis role="bold">Alpha compaction mode</emphasis> Efficient
                            encoding of digits 0 - 9; upper case letters A -Z and nine other
                            characters: space, $ % * + - . / : . </para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">Numeric compaction mode.</emphasis> Efficient
                            encoding of numeric data. For long consecutive strings of digits this
                            gives a better compaction than the alpha mode.</para>
                    </listitem>
                    <listitem>
                        <para><emphasis role="bold">Byte compaction mode.</emphasis> Used only when
                            there is a need to encode byte values as is, i.e. values in the range
                            0-255. Please note that some barcode readers, especially those with a
                            keyboard wedge, don't send back the proper encoding for ASCII values
                            lower than 32 or higher than 126. </para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>When the automatic encoding is chosen this will create an optimum encoding (from a
                size perspective) of the supplied data. This includes shifting encoding method in
                the middle of the data one or several time depending on the structure of the data. </para>
            <para>It is also possible to manually control the exact encodation of the input data.
                This is done by supplying one or more data tuples where the first entry in the tuple
                is the compaction schema and the second the data. To encode the data manually the
                following structure must then be followed:</para>
            <para>
                <figure>
                    <title>Structure for manually specify QR encodation schema</title>
                    <screen>$data = array( array( &lt;encoding_mode1> , &lt;data1> ),
               array( &lt;encoding_mode2> , &lt;data2> ),
                         ...
               array( &lt;encoding_modeN> , &lt;dataN> ));</screen>
                </figure>
            </para>
            <para>The encoding mode is specified as one of three symbolic constants</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para><code>QREncoder::MODE_NUMERIC</code></para>
                    </listitem>
                    <listitem>
                        <para><code>QREncoder::MODE_ALPHANUM</code></para>
                    </listitem>
                    <listitem>
                        <para><code>QREncoder::MODE_BYTE</code></para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>and the data is specified as a regular text string. Each section of data must
                therefore have the compaction mode specified. </para>
            <para>In order to use a specific encodation schema one has to create an array as input
                instead of the normal string input. For example, to specify an input where the
                encodation should be alphanumeric encoding of the digits '0123456789' one would have
                to create the array </para>
            <para>
                <programlisting>&lt;?php
$data = array( array( QREncoder::MODE_ALPHANUM,'0123456789') );
...
$backend->Stroke($data)
?></programlisting>
            </para>
            <para>It is also possible to use different encodings for different parts of the data in
                a similar way as the following example shows</para>
            <para>
                <programlisting>&lt;?php
$data = array( array(QREncoder::MODE_ALPHANUM,'0123456789'),
               array(QREncoder::MODE_BYTE,'ABCDEFGH') 
             );
...
...
$backend->Stroke($data)
?></programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Reading input data from a file</title>
            <para>Normally the method Backend::Stroke($aData) is sued to create a QR code from the
                datastring given. This string can of course come from a database, user input or from
                a file. The library provides a utility method </para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para><code>Backend::StrokeFromFile($aFromFile,$aToFile='')</code></para>
                        <para><code>$aFromFile</code>, The file to read the data from</para>
                        <para><code>$aToFile</code>, Optional filename to write the generated QR
                            code to</para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>which makes it easy to get data directly from a file. Otherwise it behaves exactly
                the same as the normal <code>Backend::Stroke()</code>.</para>
        </sect2>
        <sect2>
            <title>Creating different backends</title>
            <para>In order to create the actual output one or more backends must be created. The QR
                Code supports the following backends:</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para><code>BACKEND_IMAGE</code>, Create an image backend. This is the
                            default backend if no explicit backend is specified.</para>
                    </listitem>
                    <listitem>
                        <para><code>BACKEND_PS</code>, Create a postscript backend. The text string
                            that represents the postscript for the barcode is returned directly from
                            the <code>Backend::Stroke()</code></para>
                    </listitem>
                    <listitem>
                        <para><code>BACKEND_EPS</code>, Create an encapsulated postscript
                            backend</para>
                    </listitem>
                    <listitem>
                        <para><code>BACKEND_ASCII</code>, This is a special backend which will
                            generate an ASCII rendering of the datamatrix barcode. This is mostly
                            practical for technical investigations regarding the technical structure
                            of a Datamatrix barcode.</para>
                    </listitem>
                </itemizedlist>
            </para>
            <para>The following code snippet shows two ways of creating a barcode image
                backend.</para>
            <para>
                <programlisting>&lt;?php
$encoder = new QREncoder();
$backend = QRCodeBackendFactory::Create($encoder);
...
?></programlisting>
            </para>
            <para>
                <programlisting>&lt;?php
$encoder = new QREncoder();
$backend = QRCodeBackendFactory::Create($encoder,BACKEND_IMAGE);
...
?></programlisting>
            </para>
            <para>The following code shows a complete script to generate a postscript output</para>
            <para>
                <programlisting>#:qrexample11|Generating Postscript output#</programlisting>
            </para>
            <figure>
                <title>QR Code - Example Postscript Output</title>
                <mediaobject>
                    <imageobject><imagedata fileref="images/qr-postscript.png" scale="60"/></imageobject>
                </mediaobject>
            </figure>
        </sect2>
        <sect2>
            <title>Generic backend methods</title>
            <para>The following methods are available to adjust the final look and feel of the
                barcode</para>
            <para>
                <orderedlist>
                    <listitem>
                        <para><code>Backend::SetColor($aOne, $aZero,
                            $aBackground='white')</code></para>
                        <para>the color of the 'black' and 'white' modules in the barcode and the
                            quiet area around the barcode</para>
                    </listitem>
                    <listitem>
                        <para><code>Backend::SetQuietZone($aSize)</code></para>
                        <para>the size of the "quiet zone" in pixels for the image backend and in
                            points (1 pt = 1/72 inch) for the postscript backend</para>
                    </listitem>
                    <listitem>
                        <para><code>Backend::SetModuleWidth($aWidth)</code></para>
                        <para>the module width specified in pixels for the image backend and in
                            points (1 pt = 1/72 inch) for the postscript backend</para>
                    </listitem>
                    <listitem>
                        <para><code>Backend::Stroke($aData, $aFileName='')</code></para>
                        <para>create the barcode and send it back the client or store it to a file
                            if the second parameter is set. For postscript backends the postscript
                            string is returned directly from the method. (See example above)</para>
                    </listitem>
                    <listitem>
                        <para><code>Backend::StrokeFromFile($aFromFileName,$aFileName='')</code></para>
                        <para>This allows the creation of barcode directly from data in a
                            file.</para>
                    </listitem>
                </orderedlist>
            </para>
        </sect2>
        <sect2>
            <title>Image backend methods</title>
            <para>For the image backend it is possible to adjust the image encoding format with the
                following method</para>
            <para>
                <orderedlist>
                    <listitem>
                        <para>
                            <code>Backend::SetImgFormat($aFormat,$aQuality=75)</code>
                        </para>
                        <para>Specify image format. Possible values are </para>
                        <para>
                            <itemizedlist>
                                <listitem>
                                    <para>
                                        <code>'auto'</code>
                                    </para>
                                </listitem>
                                <listitem>
                                    <para>
                                        <code>'png'</code>
                                    </para>
                                </listitem>
                                <listitem>
                                    <para>
                                        <code>'jpeg'</code>
                                    </para>
                                </listitem>
                                <listitem>
                                    <para>
                                        <code>'gif'</code>
                                    </para>
                                </listitem>
                            </itemizedlist>
                        </para>
                        <para>For 'jpeg' format the quality parameter is a number in range [1-100]
                            and specified how much compression / (Data loss) should be used. 100=no
                            compression. Normal values are in the range [60-95]</para>
                        <para>The following example sets the image format to 'JPEG' with quality
                            80.</para>
                        <para>
                            <programlisting>$backend->SetImgFormat('jpeg', 80);</programlisting>
                        </para>
                    </listitem>
                </orderedlist>
            </para>
        </sect2>
        <sect2>
            <title>Postscript backend methods</title>
            <para>For postscript backend it is possible to select whether the postscript should be
                generated as encapsulated postscript. This is controlled by the method</para>
            <para>
                <itemizedlist>
                    <listitem>
                        <para><code>Backend::SetEPS($aFlg=true)</code></para>
                    </listitem>
                </itemizedlist>
            </para>
        </sect2>
        <sect2>
            <title>A template to create barcodes</title>
            <para>The following (complete) script can be used as a starting point for creation of
                more advanced barcode scripts</para>
            <para>
                <programlisting>#qr_template|A QR code template#</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Sample application</title>
            <para>As an example the library includes a WEB-based demo barcode creation application.
                This application can be used to easily create barcode through it's WEB interface. It
                is available at '<filename>qr/demoapp/index.html</filename>'</para>
            <para>This application is primarily included as a demo on the features available in the
                library and not as a finalized product.</para>
            <para><xref xlink:href="#fig.qr-demo-app"/> shows a screen shot of the application
                interface.</para>
            <figure xml:id="fig.qr-demo-app">
                <title>QR Code WEB-based demo application</title>
                <mediaobject>
                    <imageobject><imagedata fileref="images/qr-demoapp.png" scale="60"/></imageobject>
                </mediaobject>
            </figure>
        </sect2>
    </sect1>
    <sect1>
        <title>Example scripts</title>
        <para>The following sections shows a number of example script that can be used as a base for
            further refinement.</para>
        <sect2>
            <title>Example 1 - Store QR code to file</title>
            <para>QR Barcode with specified version and stored to a file</para>
            <para>
                <programlisting>#:qrexample03|Storing image to a file#</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Example 2 - Specified error correction level</title>
            <para>QR Barcode with specified version and error correction level</para>
            <para>
                <programlisting>#qrexample04|Specified error correction level#</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Example 3 - Manual specified encoding</title>
            <para>QR Barcode with manually specified encodation</para>
            <para>
                <programlisting>#qrexample05|QR Barcode with manually specified encodation#</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Example 4 - JPEG image format</title>
            <para>QR Barcode with image in JPG format</para>
            <para>
                <programlisting>#qrexample06|QR Barcode with image in JPG format#</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Example 5 - Multiple manual encoding</title>
            <para>QR Barcode with multiple manually specified encodation schema. </para>
            <para>
                <note>
                    <para>Normally there would be no need to ever use manually specified
                        encodation)</para>
                </note>
            </para>
            <para>
                <programlisting>#qrexample07|multiple manually specified encodation schema.#</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Example 6 - Reading data from file</title>
            <para>QR Barcode with data read from file</para>
            <para>
                <programlisting>#qrexample08|data read from file#</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Example 7 - Adjusting colors</title>
            <para>QR Barcode with data read from file and different colors</para>
            <para>
                <programlisting>#qrexample09#</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Example 8 - Setting error correction level</title>
            <para>Specified error correction level</para>
            <para>
                <programlisting>#qrexample10|Specified error correction level#</programlisting>
            </para>
        </sect2>
        <sect2>
            <title>Example 9 - Generating ASCII output</title>
            <para>Using the ASCII backend</para>
            <para>
                <programlisting>#:qrexample12|Using the ASCII backend#</programlisting>
            </para>
            <figure>
                <title>QR With ASCII rendering</title>
                <mediaobject>
                    <imageobject><imagedata fileref="images/qr-ASCII.png" scale="60"/></imageobject>
                </mediaobject>
            </figure>
        </sect2>
    </sect1>
</chapter>
